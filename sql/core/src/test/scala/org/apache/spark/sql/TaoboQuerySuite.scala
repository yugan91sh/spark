/*
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *    http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

package org.apache.spark.sql

import org.apache.spark.sql.catalyst.util.resourceToString

/**
 * This test suite ensures all the Star Schema Benchmark queries can be successfully analyzed,
 * optimized and compiled without hitting the max iteration threshold.
 */
class TaoboQuerySuite extends BenchmarkQueryTest {

  override def beforeAll: Unit = {
    super.beforeAll

//    wl_sal_amt DECIMAL(18,2)
//    surplus_amount DECIMAL(18,2)
//    rebate_amount DECIMAL(18,2)
//    cost_score DECIMAL(18,2)

    /* sql(
      """
        |CREATE TABLE ads_fact_pos_ord_analysis (
        |period_sdate STRING COMMENT '字符串日期',
        |qs_level_attr STRING COMMENT 'QS等级日变化',
        |pro_no STRING COMMENT '产品编码',
        |size_code STRING COMMENT '尺码',
        |brd_dtl_no STRING COMMENT '品牌编码',
        |brd_no STRING COMMENT '品牌部编码',
        |org_lno STRING COMMENT '机构原编码',
        |store_lno STRING COMMENT '店仓原编码',
        |online_offline SMALLINT COMMENT '原线上线下',
        |order_no STRING COMMENT '订单编号',
        |order_dtl_id STRING COMMENT '订单明细ID',
        |ref_bill_no STRING COMMENT '相关单号',
        |main_order_no STRING COMMENT 'MAIN_ORDER_NO',
        |third_order_no STRING COMMENT '第三方订单号',
        |yougou_order_dtl_id STRING COMMENT '优购订单明细ID',
        |order_type STRING COMMENT '退换货类型',
        |old_order_no STRING COMMENT '退换货原订单编号',
        |old_order_dtl_id STRING COMMENT '退换货原订单明细ID',
        |is_new_no SMALLINT COMMENT '新旧货编码',
        |is_new_name STRING COMMENT '新旧货',
        |virtual_activity_flag STRING COMMENT '是否虚活动',
        |sal_qty BIGINT COMMENT '销售量',
        |sal_amt DECIMAL(18,4) COMMENT '销售额',
        |sal_nos_prm_amt DECIMAL(18,4) COMMENT '销售单据牌价额',
        |sal_prm_amt DECIMAL(18,4) COMMENT '销售牌价额',
        |wl_sal_qty BIGINT COMMENT '销售量（含物料）',
        |wl_sal_amt DECIMAL(18,2) COMMENT '销售额（含物料）',
        |wl_sal_nos_prm_amt DECIMAL(18,4) COMMENT '销售单据牌价额（含物料）',
        |wl_sal_prm_amt DECIMAL(18,4) COMMENT '销售牌价额（含物料）',
        |surplus_amount DECIMAL(18,2) COMMENT '用券金额(优惠券价值)',
        |prom_sal_amt DECIMAL(18,4) COMMENT '促销销售额',
        |prom_sal_qty BIGINT COMMENT '促销销售量',
        |prom_sal_nos_prm_amt DECIMAL(18,4) COMMENT '促销销售单据牌价额',
        |customer_settle_amt DECIMAL(18,4) COMMENT '顾客成交金额',
        |customer_settle_price DECIMAL(18,4) COMMENT '顾客结算价格',
        |ticket_settle_price DECIMAL(18,4) COMMENT '券后结算价格',
        |ticket_settle_amt DECIMAL(18,4) COMMENT '券后结算金额',
        |cost_score DECIMAL(18,2) COMMENT '积分抵用额',
        |base_score DECIMAL(18,4) COMMENT '赠送积分',
        |sal_qty_sy BIGINT COMMENT '业绩量',
        |sal_amt_sy DECIMAL(18,4) COMMENT '业绩额',
        |sal_nos_prm_amt_sy DECIMAL(18,4) COMMENT '业绩单据牌价额',
        |sal_prm_amt_sy DECIMAL(18,4) COMMENT '业绩牌价额',
        |sy_send_qty BIGINT COMMENT '双算发货量',
        |sy_send_amt DECIMAL(18,4) COMMENT '双算发货额',
        |sy_send_nos_prm_amt DECIMAL(18,4) COMMENT '双算发货单据牌价额',
        |sy_send_prm_amt DECIMAL(18,4) COMMENT '双算发货牌价额',
        |discount_rate DECIMAL(18,4) COMMENT '结算对应扣率',
        |discount_amt DECIMAL(18,4) COMMENT '扣费',
        |rebate_amount DECIMAL(18,2) COMMENT '外卡抵用额',
        |sale_price DECIMAL(18,4) COMMENT '现价',
        |area_disc_rate DECIMAL(18,4) COMMENT '地区折扣底线',
        |country_disc_rate DECIMAL(18,4) COMMENT '全国折扣底线',
        |across_flag STRING COMMENT '跨店标识',
        |live_flag STRING COMMENT '直播标志',
        |ticket_no STRING COMMENT '券号，多个券逗号隔开',
        |ticket_name STRING COMMENT '券名称，多个券逗号隔开',
        |pay_way STRING COMMENT '支付方式，多个方式逗号隔开',
        |ticket_expense DECIMAL(18,4) COMMENT '用户运营部承担券抵扣金额',
        |ticket_discount DECIMAL(18,4) COMMENT '品牌部承担券抵扣金额',
        |dy_plat_surplus_amount DECIMAL(18,4) COMMENT '抖音平台优惠金额',
        |enter_store_qty BIGINT COMMENT '进店人数',
        |cust_flow_flag SMALLINT COMMENT '有客流订单标志',
        |balance_qty BIGINT COMMENT '实物存',
        |balance_prm_amt DECIMAL(18,4) COMMENT '实物存牌价额',
        |total_inv_qty BIGINT COMMENT '总库存量',
        |total_inv_prm_amt DECIMAL(18,4) COMMENT '总库存牌价额',
        |biz_inv_qty BIGINT COMMENT '业务存量',
        |biz_inv_prm_amt DECIMAL(18,4) COMMENT '业务存牌价额',
        |total_transit_in_qty BIGINT COMMENT '区内入在途量',
        |total_transit_in_amt DECIMAL(18,4) COMMENT '区内入在途额',
        |total_transit_in_account_qty BIGINT COMMENT '跨区入在途量',
        |total_transit_in_account_amt DECIMAL(18,4) COMMENT '跨区入在途额',
        |total_bad_transit_in_qty BIGINT COMMENT '次品区内入在途量',
        |total_bad_transit_in_amt DECIMAL(18,4) COMMENT '次品区内入在途牌价额',
        |total_bad_transit_in_account_qty BIGINT COMMENT '次品跨区入在途量',
        |total_bad_transit_in_account_amt DECIMAL(18,4) COMMENT '次品跨区入在途牌价额',
        |total_factory_in_qty BIGINT COMMENT '采购入在途量',
        |total_factory_in_amt DECIMAL(18,4) COMMENT '采购入在途额',
        |online_sal_inv BIGINT COMMENT '线上可售库存量',
        |online_sal_amt DECIMAL(18,4) COMMENT '线上可售库存牌价额',
        |offline_sal_inv BIGINT COMMENT '线下可售库存量',
        |offline_sal_amt DECIMAL(18,4) COMMENT '线下可售库存牌价额',
        |lock_qty BIGINT COMMENT '冻结库存量',
        |lock_amt DECIMAL(18,4) COMMENT '冻结库存牌价额',
        |occupied_qty BIGINT COMMENT '预占库存数量',
        |occupied_amt DECIMAL(18,4) COMMENT '预占库存库存额',
        |backup_qty BIGINT COMMENT '备货预占数量',
        |backup_amt DECIMAL(18,4) COMMENT '备货预占库存额',
        |work_qty BIGINT COMMENT '工服库存量',
        |work_amt DECIMAL(18,4) COMMENT '工服库存牌价额',
        |un_schedule_qty BIGINT COMMENT '不可调度数量',
        |un_schedule_amt DECIMAL(18,4) COMMENT '不可调度库存额',
        |un_share_qty BIGINT COMMENT '不可共享数量',
        |un_share_amt DECIMAL(18,4) COMMENT '不可共享牌价额',
        |third_one_level_channel_name STRING COMMENT '一级来源',
        |third_one_level_channel_no STRING COMMENT '第三方一级渠道编码',
        |third_two_level_channel_name STRING COMMENT '二级来源',
        |third_two_level_channel_no STRING COMMENT '第三方二级渠道编码',
        |third_three_level_channel_name STRING COMMENT '三级来源',
        |third_three_level_channel_no STRING COMMENT '第三方三级渠道编码',
        |order_source SMALLINT COMMENT '单据来源',
        |pay_name STRING COMMENT '支付方式',
        |status STRING COMMENT '单据状态',
        |pickup_date STRING COMMENT '提货日期',
        |adjust_flag STRING COMMENT '改单类型',
        |pay_time STRING COMMENT '订单的支付时间',
        |asst_no STRING COMMENT '营业员工号',
        |asst_name STRING COMMENT '营业员姓名',
        |pro_name_app STRING COMMENT '活动别名',
        |prom_channel STRING COMMENT '活动渠道',
        |rate_style STRING COMMENT '扣率',
        |prom_source STRING COMMENT '活动来源',
        |prom_start_time STRING COMMENT '促销活动起始日期',
        |prom_end_time STRING COMMENT '促销活动终止日期',
        |template_no STRING COMMENT '促销模板编号',
        |template_type STRING COMMENT '促销活动模板类型',
        |batch_no STRING COMMENT '活动批次号',
        |batch_name STRING COMMENT '活动批次',
        |prom_no STRING COMMENT '活动编号',
        |prom_name STRING COMMENT '活动名称',
        |price_change_bill_no STRING COMMENT '变价单单号',
        |double_sale_flag STRING COMMENT '业绩双算标志',
        |check_user_no STRING COMMENT '发货人工号',
        |check_user STRING COMMENT '发货人',
        |chat_id STRING COMMENT '群ID',
        |community_operation STRING COMMENT '小程序分销员类型',
        |sys_source_name STRING COMMENT '小程序订单来源',
        |time_flag STRING COMMENT '非常规时间销售类型',
        |special_flag STRING COMMENT '团购单标识',
        |likespecial_flag STRING COMMENT '未打标团购',
        |special_white_flag STRING COMMENT '单会员批量购买',
        |mem_id STRING COMMENT '会员号',
        |change_start_time STRING COMMENT '变价单起始时间',
        |change_end_time STRING COMMENT '变价单结束时间',
        |unusual_sal_flag STRING COMMENT '非正常销售订单标识',
        |level_attr STRING COMMENT '消费时会员等级',
        |service_evaluation STRING COMMENT '服务评价',
        |service_star BIGINT COMMENT '星级',
        |tag_name STRING COMMENT '评价内容',
        |evaluation_date STRING COMMENT '评价日期',
        |shop_no STRING COMMENT '原销售店号',
        |shop_no_from STRING COMMENT '发货店号',
        |shop_name_from STRING COMMENT '发货店仓',
        |table_source SMALLINT COMMENT 'TABLE_SOURCE',
        |sales_date STRING COMMENT '原销售日期',
        |logistics_mode SMALLINT COMMENT '自提/快递',
        |distributor_flag STRING COMMENT '分销订单标志',
        |center_distributor_flag STRING COMMENT '中心客服标志',
        |is_online SMALLINT COMMENT '是否离店',
        |merchant_no STRING COMMENT 'MERCHANT_NO',
        |distributor_no STRING COMMENT '分销员编号',
        |distributor_employee_code STRING COMMENT '分销员工号',
        |distributor_employee_name STRING COMMENT '分销员',
        |distributor_shop_no STRING COMMENT '分销归属店号',
        |distributor_shop_name STRING COMMENT '分销归属店',
        |distributor_region_name STRING COMMENT '分销员地区',
        |distributor_big_region_name STRING COMMENT '分销员大区',
        |distributor_mp_name STRING COMMENT '分销员管理省区',
        |distributor_mc_name STRING COMMENT '分销员管理城市',
        |distributor_merchant_no STRING COMMENT '分销员业务类型',
        |distributor_employee_type STRING COMMENT '分销员类型',
        |distributor_store_main_brd_no STRING COMMENT '分销员主品牌',
        |distributor_department1 STRING COMMENT '分销归属部门',
        |distributor_department2 STRING COMMENT '分销归属组',
        |room_id BIGINT COMMENT '直播间ID',
        |express_no STRING COMMENT '快递单号',
        |logistics_name STRING COMMENT '快递公司',
        |actual_postage DECIMAL(18,4) COMMENT '运费',
        |stock_in_province STRING COMMENT '顾客收货省份',
        |stock_in_city STRING COMMENT '顾客收货城市',
        |sy_org_lno STRING COMMENT '业绩归属店号',
        |sy_flag STRING COMMENT '私域业绩分类',
        |merchant_name STRING COMMENT '业务类型名称',
        |member_join_chat_follow_nos_flag STRING COMMENT '群/好友订单标志',
        |private_member_join_chat_follow_nos_flag STRING COMMENT '私域群/好友订单标志',
        |member_shop_join_nos_flag STRING COMMENT '本店群/好友订单标志',
        |private_member_shop_join_nos_flag STRING COMMENT '本店私域群/好友订单标志',
        |follow_nos_flag STRING COMMENT '好友订单标志',
        |private_follow_nos_flag STRING COMMENT '私域好友订单标志',
        |platform_name STRING COMMENT '平台名称',
        |special_sell_flag STRING COMMENT '特卖类型',
        |sal_mode_cate STRING COMMENT '销售形式大类（常规销售、预售、发售、商场团购等）',
        |time_range STRING COMMENT '时段',
        |brd_season_stc STRING COMMENT '品牌季节结构',
        |brd_season_type_name STRING COMMENT '品牌季节类型',
        |brd_season_type_order STRING COMMENT '品牌季节类型排序',
        |lsg_mon_qty BIGINT COMMENT '上市月数',
        |brd_season_no STRING COMMENT '品牌季节编码',
        |brd_season_group STRING COMMENT '品牌季节组',
        |brd_season_group_order STRING COMMENT '品牌季节组排序',
        |etl_create_time STRING COMMENT 'ETL创建时间',
        |etl_update_time STRING COMMENT 'ETL更新时间',
        |ticket_buy_amt DECIMAL(18,4) COMMENT '券成本金额',
        |sal_cost_amt DECIMAL(18,4) COMMENT '销售成本额',
        |real_pay_time STRING COMMENT '真实支付时间',
        |commission_order_type STRING COMMENT '佣金订单类型',
        |online_offline_cate_name STRING COMMENT '线上线下',
        |online_offline_name_new STRING COMMENT '线上线下细类',
        |all_cate_name STRING COMMENT '全域分类',
        |sex SMALLINT COMMENT '会员性别',
        |abnormal_mem_type STRING COMMENT '异常会员类型',
        |black_type STRING COMMENT '拉黑类型',
        |white_type STRING COMMENT '白名单类型',
        |wholesale_type STRING COMMENT '团购客类型',
        |warning_times BIGINT COMMENT '预警次数',
        |mem_brd_no STRING COMMENT '会员业务分类编码',
        |mem_status STRING COMMENT '会员状态',
        |reg_source STRING COMMENT '注册来源',
        |reg_store STRING COMMENT '注册店铺',
        |reg_big_region_name STRING COMMENT '注册大区',
        |reg_region_name STRING COMMENT '注册地区',
        |reg_mp_name STRING COMMENT '注册省区',
        |reg_mc_name STRING COMMENT '注册管理城市',
        |reg_biz_city_name STRING COMMENT '注册经营城市',
        |reg_store_brd STRING COMMENT '注册店铺品牌',
        |reg_date STRING COMMENT '注册日期',
        |level_name STRING COMMENT '会员等级1',
        |paid_mem_level SMALLINT COMMENT '是否付费会员',
        |shop_name STRING COMMENT '原销售店',
        |is_online_name STRING COMMENT '是否离店',
        |employee_native_merchant_no STRING COMMENT '员工归属业务类型',
        |room_name STRING COMMENT '直播间',
        |live_anchor_name STRING COMMENT '主播姓名',
        |live_employee_no STRING COMMENT '主播工号',
        |live_share_img STRING COMMENT '直播间分享图',
        |live_brand_code STRING COMMENT '直播间归属品牌',
        |live_region_name STRING COMMENT '直播间归属地区',
        |live_shop_no STRING COMMENT '直播间归属店号',
        |live_shop_name STRING COMMENT '直播间归属店',
        |live_start_time STRING COMMENT '直播开始时间',
        |live_end_time STRING COMMENT '直播结束时间',
        |live_start_hour_name STRING COMMENT '直播开始时段',
        |distributor_retail_province_name STRING COMMENT '分销归属零售省区',
        |distributor_retail_director_code STRING COMMENT '分销归属零售主管编码',
        |distributor_retail_director_name STRING COMMENT '分销归属零售主管',
        |distributor_retail_manager_code STRING COMMENT '分销归属零售经理编码',
        |distributor_retail_manager_name STRING COMMENT '分销归属零售经理',
        |native_distributor_flag STRING COMMENT '本店员工分销标志',
        |sy_org_name STRING COMMENT '业绩归属店',
        |nos_discount DECIMAL(18,4) COMMENT '单品销售折扣',
        |period_date STRING COMMENT '日期',
        |fin_year STRING COMMENT '财年',
        |fin_qtr SMALLINT COMMENT '财年季度',
        |year_week INT COMMENT '年周',
        |year_month STRING COMMENT '年月',
        |weekend STRING COMMENT '周末',
        |nl_holiday STRING COMMENT '农历节假日',
        |nl_sdate STRING COMMENT '农历日期',
        |brd_group_name STRING COMMENT '品牌组名称',
        |brd_group_order INT COMMENT '品牌组排序',
        |brd_abbr STRING COMMENT '品牌部简称',
        |brd_cname STRING COMMENT '品牌部中文名称',
        |brd_order SMALLINT COMMENT '品牌部排序',
        |brd_dtl_abbr STRING COMMENT '品牌简称',
        |brd_dtl_ename STRING COMMENT '品牌英文名',
        |pro_code STRING COMMENT '产品货号',
        |pro_name STRING COMMENT '产品名称',
        |pic_url STRING COMMENT '产品图片',
        |brd_season_name STRING COMMENT '品牌季节',
        |brd_season_order SMALLINT COMMENT '品牌季节排序',
        |brd_pro_season STRING COMMENT '产品季',
        |lsg_day STRING COMMENT '上市日',
        |lsg_month STRING COMMENT '上市月',
        |lsg_year STRING COMMENT '上市年',
        |pro_cate_name STRING COMMENT '产品大类',
        |pro_cate_order SMALLINT COMMENT '产品大类排序',
        |nba_logo STRING COMMENT 'NBA标志',
        |pro_down_name STRING COMMENT '上下装',
        |pro_length_name STRING COMMENT '长短装',
        |pro_series_name1 STRING COMMENT '常规系列',
        |pro_series_name2 STRING COMMENT '功能系列',
        |pro_series_name3 STRING COMMENT '故事系列',
        |pro_gender_name STRING COMMENT '性别',
        |pro_prm DECIMAL(18,4) COMMENT '牌价',
        |pro_prm_range STRING COMMENT '价格带',
        |pro_repeat_lsg STRING COMMENT '重复上市',
        |qs_level STRING COMMENT 'QS等级',
        |pro_style_name STRING COMMENT '款式',
        |pro_sub_style_name STRING COMMENT '细款',
        |pro_brd_style_name STRING COMMENT '品牌款式名称',
        |pro_repeat_season STRING COMMENT '重复季节',
        |brd_channel STRING COMMENT '品牌渠道标识',
        |pro_brd STRING COMMENT '产品品牌',
        |age_segment STRING COMMENT '产品年龄段',
        |latest_order_season STRING COMMENT '最新订货季节',
        |m_brd_season_name STRING COMMENT '全品牌品牌季节',
        |m_brd_season_order SMALLINT COMMENT '全品牌品牌季节排序',
        |m_pro_cate_name STRING COMMENT '全品牌产品大类',
        |m_pro_cate_order SMALLINT COMMENT '全品牌产品大类排序',
        |m_pro_down_name STRING COMMENT '全品牌上下装',
        |m_pro_gender_name STRING COMMENT '全品牌性别',
        |m_pro_length_name STRING COMMENT '全品牌长短装',
        |m_pro_series_name1 STRING COMMENT '全品牌常规系列',
        |m_pro_style_name STRING COMMENT '全品牌款式',
        |m_pro_sub_style_name STRING COMMENT '全品牌细款',
        |nk_cate STRING COMMENT 'NK类别',
        |offering_date STRING COMMENT '发售日期',
        |plate_code STRING COMMENT '版单号',
        |pro_biz_brd STRING COMMENT '业务品牌',
        |pro_brd_section2 STRING COMMENT '品牌类型2',
        |pro_buying_type STRING COMMENT '买货类型',
        |pro_cate_flag STRING COMMENT '物料标志',
        |pro_channel STRING COMMENT '产品渠道',
        |pro_channel_supply STRING COMMENT '渠道专供',
        |pro_chinese_subject STRING COMMENT '中文主题',
        |pro_core_models STRING COMMENT '核心款',
        |pro_distri STRING COMMENT '分配必定',
        |pro_event_subdivision STRING COMMENT '项目细分',
        |pro_evergreen STRING COMMENT '常青款',
        |pro_fabric_tech STRING COMMENT '面料科技',
        |pro_form STRING COMMENT '风格',
        |pro_function STRING COMMENT '功能作用',
        |pro_goods_nature STRING COMMENT '货品性质',
        |pro_main_color STRING COMMENT '产品主色',
        |pro_deputy_color STRING COMMENT '产品副色',
        |pro_mt_gender STRING COMMENT '多品性别',
        |pro_mt_season STRING COMMENT '多品季节',
        |pro_mt_style STRING COMMENT 'mt款式',
        |pro_national_team STRING COMMENT '国家队',
        |ballstar STRING COMMENT '球星',
        |ballteam STRING COMMENT '球队',
        |pro_pop STRING COMMENT 'pop',
        |pro_season STRING COMMENT '季节',
        |pro_shoes_style STRING COMMENT '鞋型1',
        |pro_shoes_style2 STRING COMMENT '鞋型2',
        |size_type_code STRING COMMENT '尺寸类型编码',
        |size_type_name STRING COMMENT '尺寸类型',
        |size_segment STRING COMMENT '尺码段',
        |storage_type STRING COMMENT '存储类型',
        |pro_sport_event STRING COMMENT '运动项目',
        |pro_supplement STRING COMMENT '补充线',
        |pro_support STRING COMMENT '市场支持',
        |pro_support_style STRING COMMENT '支持类型',
        |pro_support_style2 STRING COMMENT '支持类型2',
        |pro_tech STRING COMMENT '科技',
        |pro_type STRING COMMENT '版型',
        |org_new_no STRING COMMENT '机构最新编码',
        |org_name STRING COMMENT '机构名称',
        |big_region_name STRING COMMENT '大区',
        |big_region_order SMALLINT COMMENT '大区排序',
        |region_no STRING COMMENT '地区编码',
        |region_name STRING COMMENT '地区',
        |region_order SMALLINT COMMENT '地区排序',
        |mp_name STRING COMMENT '省区',
        |mc_name STRING COMMENT '管理城市',
        |biz_city_name STRING COMMENT '经营城市',
        |part_area_name STRING COMMENT '片区',
        |province_no STRING COMMENT '行政省编码',
        |province_name STRING COMMENT '行政省',
        |city_name STRING COMMENT '行政市',
        |county_name STRING COMMENT '行政县',
        |store_visualize STRING COMMENT '店铺形象',
        |store_channel STRING COMMENT '店铺渠道',
        |store_level_name STRING COMMENT '店铺级别',
        |multi_type STRING COMMENT '多品类型',
        |biz_attr_no STRING COMMENT '经营属性编码',
        |biz_attr_name STRING COMMENT '经营属性',
        |biz_attr_order SMALLINT COMMENT '经营属性排序',
        |biz_attr_no2 STRING COMMENT '经营大类编码',
        |biz_attr_name2 STRING COMMENT '经营大类',
        |biz_attr_order2 SMALLINT COMMENT '经营大类排序',
        |store_brd_flag STRING COMMENT '主寄卖',
        |key_store STRING COMMENT '重点店铺',
        |type_level STRING COMMENT '类型级别',
        |store_brd STRING COMMENT '店铺品牌',
        |org_flag STRING COMMENT '机构标志',
        |retail_director_code STRING COMMENT '多门店负责人工号',
        |retail_director_name STRING COMMENT '多门店负责人姓名',
        |retail_manager_code STRING COMMENT '零售负责人工号',
        |retail_manager_name STRING COMMENT '零售负责人姓名',
        |vsr_director_code STRING COMMENT '门店陈列师工号',
        |vsr_director_name STRING COMMENT '门店陈列师姓名',
        |vsr_manager_code STRING COMMENT '陈列专家工号',
        |vsr_manager_name STRING COMMENT '陈列专家姓名',
        |train_director_code STRING COMMENT '培训主管工号',
        |train_director_name STRING COMMENT '培训主管姓名',
        |train_manager_code STRING COMMENT '培训经理工号',
        |train_manager_name STRING COMMENT '培训经理姓名',
        |onlineop_director_code STRING COMMENT '线上运营主管工号',
        |onlineop_director_name STRING COMMENT '线上运营主管姓名',
        |onlineop_manager_code STRING COMMENT '线上运营经理工号',
        |onlineop_manager_name STRING COMMENT '线上运营经理姓名',
        |store_abbr STRING COMMENT '机构简称',
        |self_checking_mode STRING COMMENT '自收银模式',
        |biz_attr_name3 STRING COMMENT '经营细类',
        |brd_flag STRING COMMENT '品牌标识',
        |brd_store_no STRING COMMENT '品牌店号',
        |store_status STRING COMMENT '店铺状态',
        |order_unit_no STRING COMMENT '货管单位编码',
        |order_unit_name STRING COMMENT '货管单位名称',
        |retail_province_name STRING COMMENT '零售省区',
        |store_name STRING COMMENT '店仓名称',
        |internal_channel STRING COMMENT '内部渠道',
        |store_flag STRING COMMENT '店仓标志',
        |level_no STRING COMMENT '城市级别',
        |property_cooperation_cond STRING COMMENT '物业合作条件',
        |settlement_mth STRING COMMENT '结算方式',
        |store_channel_name2 STRING COMMENT '销售渠道2',
        |user_channel STRING COMMENT '对接类别',
        |org_lno2 STRING COMMENT '机构编码2',
        |mall_name STRING COMMENT '商场',
        |biz_group_name STRING COMMENT '商业集团',
        |store_type_name STRING COMMENT '店铺类型',
        |ma_name STRING COMMENT '管理区域',
        |biz_circle_name STRING COMMENT '商圈',
        |open_date STRING COMMENT '开店日',
        |close_date STRING COMMENT '关店日',
        |point_store STRING COMMENT '是否指数店',
        |area_total DECIMAL(18,4) COMMENT '总面积',
        |biz_area DECIMAL(18,4) COMMENT '营业面积',
        |tel STRING COMMENT '电话',
        |cman_addr STRING COMMENT '地址',
        |strategic_positioning STRING COMMENT '战略定位',
        |cust_store STRING COMMENT '客流店铺',
        |is_large_org STRING COMMENT '大店标志',
        |latest_renewal_time STRING COMMENT '最新改造日期',
        |store_latitude STRING COMMENT '纬度',
        |store_longitude STRING COMMENT '经度',
        |send_big_region_name STRING COMMENT '发货大区',
        |send_region_name STRING COMMENT '发货地区',
        |virtual_big_region_name STRING COMMENT '虚店大区',
        |virtual_region_name STRING COMMENT '虚店地区',
        |virtual_mc_name STRING COMMENT '虚店管理城市',
        |is_waidan STRING COMMENT '是否外单扫描店铺',
        |sal_mode_name STRING COMMENT '销售形式',
        |sal_mode_cate_name STRING COMMENT '销售形式大类',
        |sy_region_name STRING COMMENT '业绩归属地区',
        |sy_big_region_name STRING COMMENT '业绩归属大区',
        |sy_mp_name STRING COMMENT '业绩归属管理省区',
        |sy_mc_name STRING COMMENT '业绩归属管理城市',
        |online_offline_name STRING COMMENT '原线上线下',
        |m_brd_season_name_attr STRING COMMENT '历史全品牌品牌季节名称',
        |size_order STRING COMMENT '尺寸排序',
        |amt_target DECIMAL(18,4) COMMENT '营业目标',
        |gwp_flag STRING COMMENT 'GWP标签',
        |all_sal_amt DECIMAL(18,4) COMMENT '整单销售额',
        |all_sal_qty BIGINT COMMENT '整单销售量',
        |shop_mode_name STRING COMMENT '私域店铺类型' )
        |USING parquet
        |PARTITIONED BY (p_mon STRING COMMENT 'yyyymm' )
      """.stripMargin)

    sql(
      """
        |CREATE TABLE ads_fact_pos_ord_analysis_r (
        |period_sdate STRING COMMENT '字符串日期',
        |qs_level_attr STRING COMMENT 'QS等级日变化',
        |pro_no STRING COMMENT '产品编码',
        |size_code STRING COMMENT '尺码',
        |brd_dtl_no STRING COMMENT '品牌编码',
        |brd_no STRING COMMENT '品牌部编码',
        |org_lno STRING COMMENT '机构原编码',
        |store_lno STRING COMMENT '店仓原编码',
        |online_offline SMALLINT COMMENT '原线上线下',
        |order_no STRING COMMENT '订单编号',
        |order_dtl_id STRING COMMENT '订单明细ID',
        |ref_bill_no STRING COMMENT '相关单号',
        |main_order_no STRING COMMENT 'MAIN_ORDER_NO',
        |third_order_no STRING COMMENT '第三方订单号',
        |yougou_order_dtl_id STRING COMMENT '优购订单明细ID',
        |order_type STRING COMMENT '退换货类型',
        |old_order_no STRING COMMENT '退换货原订单编号',
        |old_order_dtl_id STRING COMMENT '退换货原订单明细ID',
        |is_new_no SMALLINT COMMENT '新旧货编码',
        |is_new_name STRING COMMENT '新旧货',
        |virtual_activity_flag STRING COMMENT '是否虚活动',
        |sal_qty BIGINT COMMENT '销售量',
        |sal_amt DECIMAL(18,4) COMMENT '销售额',
        |sal_nos_prm_amt DECIMAL(18,4) COMMENT '销售单据牌价额',
        |sal_prm_amt DECIMAL(18,4) COMMENT '销售牌价额',
        |wl_sal_qty BIGINT COMMENT '销售量（含物料）',
        |wl_sal_amt DECIMAL(18,2) COMMENT '销售额（含物料）',
        |wl_sal_nos_prm_amt DECIMAL(18,4) COMMENT '销售单据牌价额（含物料）',
        |wl_sal_prm_amt DECIMAL(18,4) COMMENT '销售牌价额（含物料）',
        |surplus_amount DECIMAL(18,2) COMMENT '用券金额(优惠券价值)',
        |prom_sal_amt DECIMAL(18,4) COMMENT '促销销售额',
        |prom_sal_qty BIGINT COMMENT '促销销售量',
        |prom_sal_nos_prm_amt DECIMAL(18,4) COMMENT '促销销售单据牌价额',
        |customer_settle_amt DECIMAL(18,4) COMMENT '顾客成交金额',
        |customer_settle_price DECIMAL(18,4) COMMENT '顾客结算价格',
        |ticket_settle_price DECIMAL(18,4) COMMENT '券后结算价格',
        |ticket_settle_amt DECIMAL(18,4) COMMENT '券后结算金额',
        |cost_score DECIMAL(18,2) COMMENT '积分抵用额',
        |base_score DECIMAL(18,4) COMMENT '赠送积分',
        |sal_qty_sy BIGINT COMMENT '业绩量',
        |sal_amt_sy DECIMAL(18,4) COMMENT '业绩额',
        |sal_nos_prm_amt_sy DECIMAL(18,4) COMMENT '业绩单据牌价额',
        |sal_prm_amt_sy DECIMAL(18,4) COMMENT '业绩牌价额',
        |sy_send_qty BIGINT COMMENT '双算发货量',
        |sy_send_amt DECIMAL(18,4) COMMENT '双算发货额',
        |sy_send_nos_prm_amt DECIMAL(18,4) COMMENT '双算发货单据牌价额',
        |sy_send_prm_amt DECIMAL(18,4) COMMENT '双算发货牌价额',
        |discount_rate DECIMAL(18,4) COMMENT '结算对应扣率',
        |discount_amt DECIMAL(18,4) COMMENT '扣费',
        |rebate_amount DECIMAL(18,2) COMMENT '外卡抵用额',
        |sale_price DECIMAL(18,4) COMMENT '现价',
        |area_disc_rate DECIMAL(18,4) COMMENT '地区折扣底线',
        |country_disc_rate DECIMAL(18,4) COMMENT '全国折扣底线',
        |across_flag STRING COMMENT '跨店标识',
        |live_flag STRING COMMENT '直播标志',
        |ticket_no STRING COMMENT '券号，多个券逗号隔开',
        |ticket_name STRING COMMENT '券名称，多个券逗号隔开',
        |pay_way STRING COMMENT '支付方式，多个方式逗号隔开',
        |ticket_expense DECIMAL(18,4) COMMENT '用户运营部承担券抵扣金额',
        |ticket_discount DECIMAL(18,4) COMMENT '品牌部承担券抵扣金额',
        |dy_plat_surplus_amount DECIMAL(18,4) COMMENT '抖音平台优惠金额',
        |enter_store_qty BIGINT COMMENT '进店人数',
        |cust_flow_flag SMALLINT COMMENT '有客流订单标志',
        |balance_qty BIGINT COMMENT '实物存',
        |balance_prm_amt DECIMAL(18,4) COMMENT '实物存牌价额',
        |total_inv_qty BIGINT COMMENT '总库存量',
        |total_inv_prm_amt DECIMAL(18,4) COMMENT '总库存牌价额',
        |biz_inv_qty BIGINT COMMENT '业务存量',
        |biz_inv_prm_amt DECIMAL(18,4) COMMENT '业务存牌价额',
        |total_transit_in_qty BIGINT COMMENT '区内入在途量',
        |total_transit_in_amt DECIMAL(18,4) COMMENT '区内入在途额',
        |total_transit_in_account_qty BIGINT COMMENT '跨区入在途量',
        |total_transit_in_account_amt DECIMAL(18,4) COMMENT '跨区入在途额',
        |total_bad_transit_in_qty BIGINT COMMENT '次品区内入在途量',
        |total_bad_transit_in_amt DECIMAL(18,4) COMMENT '次品区内入在途牌价额',
        |total_bad_transit_in_account_qty BIGINT COMMENT '次品跨区入在途量',
        |total_bad_transit_in_account_amt DECIMAL(18,4) COMMENT '次品跨区入在途牌价额',
        |total_factory_in_qty BIGINT COMMENT '采购入在途量',
        |total_factory_in_amt DECIMAL(18,4) COMMENT '采购入在途额',
        |online_sal_inv BIGINT COMMENT '线上可售库存量',
        |online_sal_amt DECIMAL(18,4) COMMENT '线上可售库存牌价额',
        |offline_sal_inv BIGINT COMMENT '线下可售库存量',
        |offline_sal_amt DECIMAL(18,4) COMMENT '线下可售库存牌价额',
        |lock_qty BIGINT COMMENT '冻结库存量',
        |lock_amt DECIMAL(18,4) COMMENT '冻结库存牌价额',
        |occupied_qty BIGINT COMMENT '预占库存数量',
        |occupied_amt DECIMAL(18,4) COMMENT '预占库存库存额',
        |backup_qty BIGINT COMMENT '备货预占数量',
        |backup_amt DECIMAL(18,4) COMMENT '备货预占库存额',
        |work_qty BIGINT COMMENT '工服库存量',
        |work_amt DECIMAL(18,4) COMMENT '工服库存牌价额',
        |un_schedule_qty BIGINT COMMENT '不可调度数量',
        |un_schedule_amt DECIMAL(18,4) COMMENT '不可调度库存额',
        |un_share_qty BIGINT COMMENT '不可共享数量',
        |un_share_amt DECIMAL(18,4) COMMENT '不可共享牌价额',
        |third_one_level_channel_name STRING COMMENT '一级来源',
        |third_one_level_channel_no STRING COMMENT '第三方一级渠道编码',
        |third_two_level_channel_name STRING COMMENT '二级来源',
        |third_two_level_channel_no STRING COMMENT '第三方二级渠道编码',
        |third_three_level_channel_name STRING COMMENT '三级来源',
        |third_three_level_channel_no STRING COMMENT '第三方三级渠道编码',
        |order_source SMALLINT COMMENT '单据来源',
        |pay_name STRING COMMENT '支付方式',
        |status STRING COMMENT '单据状态',
        |pickup_date STRING COMMENT '提货日期',
        |adjust_flag STRING COMMENT '改单类型',
        |pay_time STRING COMMENT '订单的支付时间',
        |asst_no STRING COMMENT '营业员工号',
        |asst_name STRING COMMENT '营业员姓名',
        |pro_name_app STRING COMMENT '活动别名',
        |prom_channel STRING COMMENT '活动渠道',
        |rate_style STRING COMMENT '扣率',
        |prom_source STRING COMMENT '活动来源',
        |prom_start_time STRING COMMENT '促销活动起始日期',
        |prom_end_time STRING COMMENT '促销活动终止日期',
        |template_no STRING COMMENT '促销模板编号',
        |template_type STRING COMMENT '促销活动模板类型',
        |batch_no STRING COMMENT '活动批次号',
        |batch_name STRING COMMENT '活动批次',
        |prom_no STRING COMMENT '活动编号',
        |prom_name STRING COMMENT '活动名称',
        |price_change_bill_no STRING COMMENT '变价单单号',
        |double_sale_flag STRING COMMENT '业绩双算标志',
        |check_user_no STRING COMMENT '发货人工号',
        |check_user STRING COMMENT '发货人',
        |chat_id STRING COMMENT '群ID',
        |community_operation STRING COMMENT '分销员类型',
        |sys_source_name STRING COMMENT '小程序订单来源',
        |time_flag STRING COMMENT '非常规时间销售类型',
        |special_flag STRING COMMENT '团购单标识',
        |likespecial_flag STRING COMMENT '未打标团购',
        |special_white_flag STRING COMMENT '单会员批量购买',
        |mem_id STRING COMMENT '会员号',
        |change_start_time STRING COMMENT '变价单起始时间',
        |change_end_time STRING COMMENT '变价单结束时间',
        |unusual_sal_flag STRING COMMENT '非正常销售订单标识',
        |level_attr STRING COMMENT '消费时会员等级',
        |service_evaluation STRING COMMENT '服务评价',
        |service_star BIGINT COMMENT '星级',
        |tag_name STRING COMMENT '评价内容',
        |evaluation_date STRING COMMENT '评价日期',
        |shop_no STRING COMMENT '原销售店号',
        |shop_no_from STRING COMMENT '发货店号',
        |shop_name_from STRING COMMENT '发货店仓',
        |table_source SMALLINT COMMENT 'TABLE_SOURCE',
        |sales_date STRING COMMENT '原销售日期',
        |logistics_mode SMALLINT COMMENT '自提/快递',
        |distributor_flag STRING COMMENT '分销订单标志',
        |center_distributor_flag STRING COMMENT '中心客服标志',
        |is_online SMALLINT COMMENT '是否离店',
        |merchant_no STRING COMMENT 'MERCHANT_NO',
        |distributor_no STRING COMMENT '分销员编号',
        |distributor_employee_code STRING COMMENT '分销员工号',
        |distributor_employee_name STRING COMMENT '分销员',
        |distributor_shop_no STRING COMMENT '分销归属店号',
        |distributor_shop_name STRING COMMENT '分销归属店',
        |distributor_region_name STRING COMMENT '分销员地区',
        |distributor_big_region_name STRING COMMENT '分销员大区',
        |distributor_mp_name STRING COMMENT '分销员管理省区',
        |distributor_mc_name STRING COMMENT '分销员管理城市',
        |distributor_merchant_no STRING COMMENT '分销员业务类型',
        |distributor_employee_type STRING COMMENT '分销员类型',
        |distributor_store_main_brd_no STRING COMMENT '分销员主品牌',
        |distributor_department1 STRING COMMENT '分销归属部门',
        |distributor_department2 STRING COMMENT '分销归属组',
        |room_id BIGINT COMMENT '直播间ID',
        |express_no STRING COMMENT '快递单号',
        |logistics_name STRING COMMENT '快递公司',
        |actual_postage DECIMAL(18,4) COMMENT '运费',
        |stock_in_province STRING COMMENT '顾客收货省份',
        |stock_in_city STRING COMMENT '顾客收货城市',
        |sy_org_lno STRING COMMENT '业绩归属店号',
        |sy_flag STRING COMMENT '私域业绩分类',
        |merchant_name STRING COMMENT '业务类型名称',
        |member_join_chat_follow_nos_flag STRING COMMENT '群/好友订单标志',
        |private_member_join_chat_follow_nos_flag STRING COMMENT '私域群/好友订单标志',
        |member_shop_join_nos_flag STRING COMMENT '本店群/好友订单标志',
        |private_member_shop_join_nos_flag STRING COMMENT '本店私域群/好友订单标志',
        |follow_nos_flag STRING COMMENT '好友订单标志',
        |private_follow_nos_flag STRING COMMENT '私域好友订单标志',
        |platform_name STRING COMMENT '平台名称',
        |special_sell_flag STRING COMMENT '特卖类型',
        |sal_mode_cate STRING COMMENT '销售形式大类（常规销售、预售、发售、商场团购等）',
        |time_range STRING COMMENT '时段',
        |brd_season_stc STRING COMMENT '品牌季节结构',
        |brd_season_type_name STRING COMMENT '品牌季节类型',
        |brd_season_type_order STRING COMMENT '品牌季节类型排序',
        |lsg_mon_qty BIGINT COMMENT '上市月数',
        |brd_season_no STRING COMMENT '品牌季节编码',
        |brd_season_group STRING COMMENT '品牌季节组',
        |brd_season_group_order STRING COMMENT '品牌季节组排序',
        |etl_create_time STRING COMMENT 'ETL创建时间',
        |etl_update_time STRING COMMENT 'ETL更新时间',
        |ticket_buy_amt DECIMAL(18,4) COMMENT '券成本金额',
        |sal_cost_amt DECIMAL(18,4) COMMENT '销售成本额',
        |real_pay_time STRING COMMENT '真实支付时间',
        |commission_order_type STRING COMMENT '佣金订单类型',
        |online_offline_cate_name STRING COMMENT '线上线下',
        |online_offline_name_new STRING COMMENT '线上线下细类',
        |all_cate_name STRING COMMENT '全域分类',
        |sex SMALLINT COMMENT '会员性别',
        |abnormal_mem_type STRING COMMENT '异常会员类型',
        |black_type STRING COMMENT '拉黑类型',
        |white_type STRING COMMENT '白名单类型',
        |wholesale_type STRING COMMENT '团购客类型',
        |warning_times BIGINT COMMENT '预警次数',
        |mem_brd_no STRING COMMENT '会员业务分类编码',
        |mem_status STRING COMMENT '会员状态',
        |reg_source STRING COMMENT '注册来源',
        |reg_store STRING COMMENT '注册店铺',
        |reg_big_region_name STRING COMMENT '注册大区',
        |reg_region_name STRING COMMENT '注册地区',
        |reg_mp_name STRING COMMENT '注册省区',
        |reg_mc_name STRING COMMENT '注册管理城市',
        |reg_biz_city_name STRING COMMENT '注册经营城市',
        |reg_store_brd STRING COMMENT '注册店铺品牌',
        |reg_date STRING COMMENT '注册日期',
        |level_name STRING COMMENT '会员等级1',
        |paid_mem_level SMALLINT COMMENT '是否付费会员',
        |shop_name STRING COMMENT '原销售店',
        |is_online_name STRING COMMENT '是否离店',
        |employee_native_merchant_no STRING COMMENT '员工归属业务类型',
        |room_name STRING COMMENT '直播间',
        |live_anchor_name STRING COMMENT '主播姓名',
        |live_employee_no STRING COMMENT '主播工号',
        |live_share_img STRING COMMENT '直播间分享图',
        |live_brand_code STRING COMMENT '直播间归属品牌',
        |live_region_name STRING COMMENT '直播间归属地区',
        |live_shop_no STRING COMMENT '直播间归属店号',
        |live_shop_name STRING COMMENT '直播间归属店',
        |live_start_time STRING COMMENT '直播开始时间',
        |live_end_time STRING COMMENT '直播结束时间',
        |live_start_hour_name STRING COMMENT '直播开始时段',
        |distributor_retail_province_name STRING COMMENT '分销归属零售省区',
        |distributor_retail_director_code STRING COMMENT '分销归属零售主管编码',
        |distributor_retail_director_name STRING COMMENT '分销归属零售主管',
        |distributor_retail_manager_code STRING COMMENT '分销归属零售经理编码',
        |distributor_retail_manager_name STRING COMMENT '分销归属零售经理',
        |native_distributor_flag STRING COMMENT '本店员工分销标志',
        |sy_org_name STRING COMMENT '业绩归属店',
        |nos_discount DECIMAL(18,4) COMMENT '单品销售折扣',
        |period_date STRING COMMENT '日期',
        |fin_year STRING COMMENT '财年',
        |fin_qtr SMALLINT COMMENT '财年季度',
        |year_week INT COMMENT '年周',
        |year_month STRING COMMENT '年月',
        |weekend STRING COMMENT '周末',
        |nl_holiday STRING COMMENT '农历节假日',
        |nl_sdate STRING COMMENT '农历日期',
        |brd_group_name STRING COMMENT '品牌组名称',
        |brd_group_order INT COMMENT '品牌组排序',
        |brd_abbr STRING COMMENT '品牌部简称',
        |brd_cname STRING COMMENT '品牌部中文名称',
        |brd_order SMALLINT COMMENT '品牌部排序',
        |brd_dtl_abbr STRING COMMENT '品牌简称',
        |brd_dtl_ename STRING COMMENT '品牌英文名',
        |pro_code STRING COMMENT '产品货号',
        |pro_name STRING COMMENT '产品名称',
        |pic_url STRING COMMENT '产品图片',
        |brd_season_name STRING COMMENT '品牌季节',
        |brd_season_order SMALLINT COMMENT '品牌季节排序',
        |brd_pro_season STRING COMMENT '产品季',
        |lsg_day STRING COMMENT '上市日',
        |lsg_month STRING COMMENT '上市月',
        |lsg_year STRING COMMENT '上市年',
        |pro_cate_name STRING COMMENT '产品大类',
        |pro_cate_order SMALLINT COMMENT '产品大类排序',
        |nba_logo STRING COMMENT 'NBA标志',
        |pro_down_name STRING COMMENT '上下装',
        |pro_length_name STRING COMMENT '长短装',
        |pro_series_name1 STRING COMMENT '常规系列',
        |pro_series_name2 STRING COMMENT '功能系列',
        |pro_series_name3 STRING COMMENT '故事系列',
        |pro_gender_name STRING COMMENT '性别',
        |pro_prm DECIMAL(18,4) COMMENT '牌价',
        |pro_prm_range STRING COMMENT '价格带',
        |pro_repeat_lsg STRING COMMENT '重复上市',
        |qs_level STRING COMMENT 'QS等级',
        |pro_style_name STRING COMMENT '款式',
        |pro_sub_style_name STRING COMMENT '细款',
        |pro_brd_style_name STRING COMMENT '品牌款式名称',
        |pro_repeat_season STRING COMMENT '重复季节',
        |brd_channel STRING COMMENT '品牌渠道标识',
        |pro_brd STRING COMMENT '产品品牌',
        |age_segment STRING COMMENT '产品年龄段',
        |latest_order_season STRING COMMENT '最新订货季节',
        |m_brd_season_name STRING COMMENT '全品牌品牌季节',
        |m_brd_season_order SMALLINT COMMENT '全品牌品牌季节排序',
        |m_pro_cate_name STRING COMMENT '全品牌产品大类',
        |m_pro_cate_order SMALLINT COMMENT '全品牌产品大类排序',
        |m_pro_down_name STRING COMMENT '全品牌上下装',
        |m_pro_gender_name STRING COMMENT '全品牌性别',
        |m_pro_length_name STRING COMMENT '全品牌长短装',
        |m_pro_series_name1 STRING COMMENT '全品牌常规系列',
        |m_pro_style_name STRING COMMENT '全品牌款式',
        |m_pro_sub_style_name STRING COMMENT '全品牌细款',
        |nk_cate STRING COMMENT 'NK类别',
        |offering_date STRING COMMENT '发售日期',
        |plate_code STRING COMMENT '版单号',
        |pro_biz_brd STRING COMMENT '业务品牌',
        |pro_brd_section2 STRING COMMENT '品牌类型2',
        |pro_buying_type STRING COMMENT '买货类型',
        |pro_cate_flag STRING COMMENT '物料标志',
        |pro_channel STRING COMMENT '产品渠道',
        |pro_channel_supply STRING COMMENT '渠道专供',
        |pro_chinese_subject STRING COMMENT '中文主题',
        |pro_core_models STRING COMMENT '核心款',
        |pro_distri STRING COMMENT '分配必定',
        |pro_event_subdivision STRING COMMENT '项目细分',
        |pro_evergreen STRING COMMENT '常青款',
        |pro_fabric_tech STRING COMMENT '面料科技',
        |pro_form STRING COMMENT '风格',
        |pro_function STRING COMMENT '功能作用',
        |pro_goods_nature STRING COMMENT '货品性质',
        |pro_main_color STRING COMMENT '产品主色',
        |pro_deputy_color STRING COMMENT '产品副色',
        |pro_mt_gender STRING COMMENT '多品性别',
        |pro_mt_season STRING COMMENT '多品季节',
        |pro_mt_style STRING COMMENT 'mt款式',
        |pro_national_team STRING COMMENT '国家队',
        |ballstar STRING COMMENT '球星',
        |ballteam STRING COMMENT '球队',
        |pro_pop STRING COMMENT 'pop',
        |pro_season STRING COMMENT '季节',
        |pro_shoes_style STRING COMMENT '鞋型1',
        |pro_shoes_style2 STRING COMMENT '鞋型2',
        |size_type_code STRING COMMENT '尺寸类型编码',
        |size_type_name STRING COMMENT '尺寸类型',
        |size_segment STRING COMMENT '尺码段',
        |storage_type STRING COMMENT '存储类型',
        |pro_sport_event STRING COMMENT '运动项目',
        |pro_supplement STRING COMMENT '补充线',
        |pro_support STRING COMMENT '市场支持',
        |pro_support_style STRING COMMENT '支持类型',
        |pro_support_style2 STRING COMMENT '支持类型2',
        |pro_tech STRING COMMENT '科技',
        |pro_type STRING COMMENT '版型',
        |org_new_no STRING COMMENT '机构最新编码',
        |org_name STRING COMMENT '机构名称',
        |big_region_name STRING COMMENT '大区',
        |big_region_order SMALLINT COMMENT '大区排序',
        |region_no STRING COMMENT '地区编码',
        |region_name STRING COMMENT '地区',
        |region_order SMALLINT COMMENT '地区排序',
        |mp_name STRING COMMENT '省区',
        |mc_name STRING COMMENT '管理城市',
        |biz_city_name STRING COMMENT '经营城市',
        |part_area_name STRING COMMENT '片区',
        |province_no STRING COMMENT '行政省编码',
        |province_name STRING COMMENT '行政省',
        |city_name STRING COMMENT '行政市',
        |county_name STRING COMMENT '行政县',
        |store_visualize STRING COMMENT '店铺形象',
        |store_channel STRING COMMENT '店铺渠道',
        |store_level_name STRING COMMENT '店铺级别',
        |multi_type STRING COMMENT '多品类型',
        |biz_attr_no STRING COMMENT '经营属性编码',
        |biz_attr_name STRING COMMENT '经营属性',
        |biz_attr_order SMALLINT COMMENT '经营属性排序',
        |biz_attr_no2 STRING COMMENT '经营大类编码',
        |biz_attr_name2 STRING COMMENT '经营大类',
        |biz_attr_order2 SMALLINT COMMENT '经营大类排序',
        |store_brd_flag STRING COMMENT '主寄卖',
        |key_store STRING COMMENT '重点店铺',
        |type_level STRING COMMENT '类型级别',
        |store_brd STRING COMMENT '店铺品牌',
        |org_flag STRING COMMENT '机构标志',
        |retail_director_code STRING COMMENT '多门店负责人工号',
        |retail_director_name STRING COMMENT '多门店负责人姓名',
        |retail_manager_code STRING COMMENT '零售负责人工号',
        |retail_manager_name STRING COMMENT '零售负责人姓名',
        |vsr_director_code STRING COMMENT '门店陈列师工号',
        |vsr_director_name STRING COMMENT '门店陈列师姓名',
        |vsr_manager_code STRING COMMENT '陈列专家工号',
        |vsr_manager_name STRING COMMENT '陈列专家姓名',
        |train_director_code STRING COMMENT '培训主管工号',
        |train_director_name STRING COMMENT '培训主管姓名',
        |train_manager_code STRING COMMENT '培训经理工号',
        |train_manager_name STRING COMMENT '培训经理姓名',
        |onlineop_director_code STRING COMMENT '线上运营主管工号',
        |onlineop_director_name STRING COMMENT '线上运营主管姓名',
        |onlineop_manager_code STRING COMMENT '线上运营经理工号',
        |onlineop_manager_name STRING COMMENT '线上运营经理姓名',
        |store_abbr STRING COMMENT '机构简称',
        |self_checking_mode STRING COMMENT '自收银模式',
        |biz_attr_name3 STRING COMMENT '经营细类',
        |brd_flag STRING COMMENT '品牌标识',
        |brd_store_no STRING COMMENT '品牌店号',
        |store_status STRING COMMENT '店铺状态',
        |order_unit_no STRING COMMENT '货管单位编码',
        |order_unit_name STRING COMMENT '货管单位名称',
        |retail_province_name STRING COMMENT '零售省区',
        |store_name STRING COMMENT '店仓名称',
        |internal_channel STRING COMMENT '内部渠道',
        |store_flag STRING COMMENT '店仓标志',
        |level_no STRING COMMENT '城市级别',
        |property_cooperation_cond STRING COMMENT '物业合作条件',
        |settlement_mth STRING COMMENT '结算方式',
        |store_channel_name2 STRING COMMENT '销售渠道2',
        |user_channel STRING COMMENT '对接类别',
        |org_lno2 STRING COMMENT '机构编码2',
        |mall_name STRING COMMENT '商场',
        |biz_group_name STRING COMMENT '商业集团',
        |store_type_name STRING COMMENT '店铺类型',
        |ma_name STRING COMMENT '管理区域',
        |biz_circle_name STRING COMMENT '商圈',
        |open_date STRING COMMENT '开店日',
        |close_date STRING COMMENT '关店日',
        |point_store STRING COMMENT '是否指数店',
        |area_total DECIMAL(18,4) COMMENT '总面积',
        |biz_area DECIMAL(18,4) COMMENT '营业面积',
        |tel STRING COMMENT '电话',
        |cman_addr STRING COMMENT '地址',
        |strategic_positioning STRING COMMENT '战略定位',
        |cust_store STRING COMMENT '客流店铺',
        |is_large_org STRING COMMENT '大店标志',
        |latest_renewal_time STRING COMMENT '最新改造日期',
        |store_latitude STRING COMMENT '纬度',
        |store_longitude STRING COMMENT '经度',
        |send_big_region_name STRING COMMENT '发货大区',
        |send_region_name STRING COMMENT '发货地区',
        |virtual_big_region_name STRING COMMENT '虚店大区',
        |virtual_region_name STRING COMMENT '虚店地区',
        |virtual_mc_name STRING COMMENT '虚店管理城市',
        |is_waidan STRING COMMENT '是否外单扫描店铺',
        |sal_mode_name STRING COMMENT '销售形式',
        |sal_mode_cate_name STRING COMMENT '销售形式大类',
        |sy_region_name STRING COMMENT '业绩归属地区',
        |sy_big_region_name STRING COMMENT '业绩归属大区',
        |sy_mp_name STRING COMMENT '业绩归属管理省区',
        |sy_mc_name STRING COMMENT '业绩归属管理城市',
        |online_offline_name STRING COMMENT '原线上线下',
        |m_brd_season_name_attr STRING COMMENT '历史全品牌品牌季节名称',
        |size_order STRING COMMENT '尺寸排序',
        |amt_target DECIMAL(18,4) COMMENT '营业目标',
        |gwp_flag STRING COMMENT 'GWP标签',
        |all_sal_amt DECIMAL(18,4) COMMENT '整单销售额',
        |all_sal_qty BIGINT COMMENT '整单销售量',
        |shop_mode_name STRING COMMENT '私域店铺类型',
        |bad_balance_inv_qty BIGINT COMMENT '次品实物存量',
        |bad_balance_inv_amt DECIMAL(18,4) COMMENT '次品实物存额',
        |outer_manu_qty BIGINT COMMENT '正品退厂库存量',
        |outer_manu_amt DECIMAL(18,4) COMMENT '正品退厂库存额',
        |bad_outer_manu_qty BIGINT COMMENT '次品退厂库存量',
        |bad_outer_manu_amt DECIMAL(18,4) COMMENT '次品退厂库存额',
        |guest_bad_qty BIGINT COMMENT '客残量',
        |guest_bad_amt DECIMAL(18,4) COMMENT '客残额',
        |pre_destroy_qty BIGINT COMMENT '待销毁量',
        |pre_destroy_amt DECIMAL(18,4) COMMENT '待销毁额',
        |original_bad_qty BIGINT COMMENT '原残量',
        |original_bad_amt DECIMAL(18,4) COMMENT '原残额' )
        |USING parquet
      """.stripMargin) */

//    wl_sal_amt DECIMAL(18,4)
//    surplus_amount DECIMAL(18,4)
//    rebate_amount DECIMAL(18,4)
//    cost_score DECIMAL(18,4)

    sql(
      """
        |CREATE TABLE ads_fact_pos_ord_analysis (
        |period_sdate STRING COMMENT '字符串日期',
        |qs_level_attr STRING COMMENT 'QS等级日变化',
        |pro_no STRING COMMENT '产品编码',
        |size_code STRING COMMENT '尺码',
        |brd_dtl_no STRING COMMENT '品牌编码',
        |brd_no STRING COMMENT '品牌部编码',
        |org_lno STRING COMMENT '机构原编码',
        |store_lno STRING COMMENT '店仓原编码',
        |online_offline SMALLINT COMMENT '原线上线下',
        |order_no STRING COMMENT '订单编号',
        |order_dtl_id STRING COMMENT '订单明细ID',
        |ref_bill_no STRING COMMENT '相关单号',
        |main_order_no STRING COMMENT 'MAIN_ORDER_NO',
        |third_order_no STRING COMMENT '第三方订单号',
        |yougou_order_dtl_id STRING COMMENT '优购订单明细ID',
        |order_type STRING COMMENT '退换货类型',
        |old_order_no STRING COMMENT '退换货原订单编号',
        |old_order_dtl_id STRING COMMENT '退换货原订单明细ID',
        |is_new_no SMALLINT COMMENT '新旧货编码',
        |is_new_name STRING COMMENT '新旧货',
        |virtual_activity_flag STRING COMMENT '是否虚活动',
        |sal_qty BIGINT COMMENT '销售量',
        |sal_amt DECIMAL(18,4) COMMENT '销售额',
        |sal_nos_prm_amt DECIMAL(18,4) COMMENT '销售单据牌价额',
        |sal_prm_amt DECIMAL(18,4) COMMENT '销售牌价额',
        |wl_sal_qty BIGINT COMMENT '销售量（含物料）',
        |wl_sal_amt DECIMAL(18,4) COMMENT '销售额（含物料）',
        |wl_sal_nos_prm_amt DECIMAL(18,4) COMMENT '销售单据牌价额（含物料）',
        |wl_sal_prm_amt DECIMAL(18,4) COMMENT '销售牌价额（含物料）',
        |surplus_amount DECIMAL(18,4) COMMENT '用券金额(优惠券价值)',
        |prom_sal_amt DECIMAL(18,4) COMMENT '促销销售额',
        |prom_sal_qty BIGINT COMMENT '促销销售量',
        |prom_sal_nos_prm_amt DECIMAL(18,4) COMMENT '促销销售单据牌价额',
        |customer_settle_amt DECIMAL(18,4) COMMENT '顾客成交金额',
        |customer_settle_price DECIMAL(18,4) COMMENT '顾客结算价格',
        |ticket_settle_price DECIMAL(18,4) COMMENT '券后结算价格',
        |ticket_settle_amt DECIMAL(18,4) COMMENT '券后结算金额',
        |cost_score DECIMAL(18,4) COMMENT '积分抵用额',
        |base_score DECIMAL(18,4) COMMENT '赠送积分',
        |sal_qty_sy BIGINT COMMENT '业绩量',
        |sal_amt_sy DECIMAL(18,4) COMMENT '业绩额',
        |sal_nos_prm_amt_sy DECIMAL(18,4) COMMENT '业绩单据牌价额',
        |sal_prm_amt_sy DECIMAL(18,4) COMMENT '业绩牌价额',
        |sy_send_qty BIGINT COMMENT '双算发货量',
        |sy_send_amt DECIMAL(18,4) COMMENT '双算发货额',
        |sy_send_nos_prm_amt DECIMAL(18,4) COMMENT '双算发货单据牌价额',
        |sy_send_prm_amt DECIMAL(18,4) COMMENT '双算发货牌价额',
        |discount_rate DECIMAL(18,4) COMMENT '结算对应扣率',
        |discount_amt DECIMAL(18,4) COMMENT '扣费',
        |rebate_amount DECIMAL(18,4) COMMENT '外卡抵用额',
        |sale_price DECIMAL(18,4) COMMENT '现价',
        |area_disc_rate DECIMAL(18,4) COMMENT '地区折扣底线',
        |country_disc_rate DECIMAL(18,4) COMMENT '全国折扣底线',
        |across_flag STRING COMMENT '跨店标识',
        |live_flag STRING COMMENT '直播标志',
        |ticket_no STRING COMMENT '券号，多个券逗号隔开',
        |ticket_name STRING COMMENT '券名称，多个券逗号隔开',
        |pay_way STRING COMMENT '支付方式，多个方式逗号隔开',
        |ticket_expense DECIMAL(18,4) COMMENT '用户运营部承担券抵扣金额',
        |ticket_discount DECIMAL(18,4) COMMENT '品牌部承担券抵扣金额',
        |dy_plat_surplus_amount DECIMAL(18,4) COMMENT '抖音平台优惠金额',
        |enter_store_qty BIGINT COMMENT '进店人数',
        |cust_flow_flag SMALLINT COMMENT '有客流订单标志',
        |balance_qty BIGINT COMMENT '实物存',
        |balance_prm_amt DECIMAL(18,4) COMMENT '实物存牌价额',
        |total_inv_qty BIGINT COMMENT '总库存量',
        |total_inv_prm_amt DECIMAL(18,4) COMMENT '总库存牌价额',
        |biz_inv_qty BIGINT COMMENT '业务存量',
        |biz_inv_prm_amt DECIMAL(18,4) COMMENT '业务存牌价额',
        |total_transit_in_qty BIGINT COMMENT '区内入在途量',
        |total_transit_in_amt DECIMAL(18,4) COMMENT '区内入在途额',
        |total_transit_in_account_qty BIGINT COMMENT '跨区入在途量',
        |total_transit_in_account_amt DECIMAL(18,4) COMMENT '跨区入在途额',
        |total_bad_transit_in_qty BIGINT COMMENT '次品区内入在途量',
        |total_bad_transit_in_amt DECIMAL(18,4) COMMENT '次品区内入在途牌价额',
        |total_bad_transit_in_account_qty BIGINT COMMENT '次品跨区入在途量',
        |total_bad_transit_in_account_amt DECIMAL(18,4) COMMENT '次品跨区入在途牌价额',
        |total_factory_in_qty BIGINT COMMENT '采购入在途量',
        |total_factory_in_amt DECIMAL(18,4) COMMENT '采购入在途额',
        |online_sal_inv BIGINT COMMENT '线上可售库存量',
        |online_sal_amt DECIMAL(18,4) COMMENT '线上可售库存牌价额',
        |offline_sal_inv BIGINT COMMENT '线下可售库存量',
        |offline_sal_amt DECIMAL(18,4) COMMENT '线下可售库存牌价额',
        |lock_qty BIGINT COMMENT '冻结库存量',
        |lock_amt DECIMAL(18,4) COMMENT '冻结库存牌价额',
        |occupied_qty BIGINT COMMENT '预占库存数量',
        |occupied_amt DECIMAL(18,4) COMMENT '预占库存库存额',
        |backup_qty BIGINT COMMENT '备货预占数量',
        |backup_amt DECIMAL(18,4) COMMENT '备货预占库存额',
        |work_qty BIGINT COMMENT '工服库存量',
        |work_amt DECIMAL(18,4) COMMENT '工服库存牌价额',
        |un_schedule_qty BIGINT COMMENT '不可调度数量',
        |un_schedule_amt DECIMAL(18,4) COMMENT '不可调度库存额',
        |un_share_qty BIGINT COMMENT '不可共享数量',
        |un_share_amt DECIMAL(18,4) COMMENT '不可共享牌价额',
        |third_one_level_channel_name STRING COMMENT '一级来源',
        |third_one_level_channel_no STRING COMMENT '第三方一级渠道编码',
        |third_two_level_channel_name STRING COMMENT '二级来源',
        |third_two_level_channel_no STRING COMMENT '第三方二级渠道编码',
        |third_three_level_channel_name STRING COMMENT '三级来源',
        |third_three_level_channel_no STRING COMMENT '第三方三级渠道编码',
        |order_source SMALLINT COMMENT '单据来源',
        |pay_name STRING COMMENT '支付方式',
        |status STRING COMMENT '单据状态',
        |pickup_date STRING COMMENT '提货日期',
        |adjust_flag STRING COMMENT '改单类型',
        |pay_time STRING COMMENT '订单的支付时间',
        |asst_no STRING COMMENT '营业员工号',
        |asst_name STRING COMMENT '营业员姓名',
        |pro_name_app STRING COMMENT '活动别名',
        |prom_channel STRING COMMENT '活动渠道',
        |rate_style STRING COMMENT '扣率',
        |prom_source STRING COMMENT '活动来源',
        |prom_start_time STRING COMMENT '促销活动起始日期',
        |prom_end_time STRING COMMENT '促销活动终止日期',
        |template_no STRING COMMENT '促销模板编号',
        |template_type STRING COMMENT '促销活动模板类型',
        |batch_no STRING COMMENT '活动批次号',
        |batch_name STRING COMMENT '活动批次',
        |prom_no STRING COMMENT '活动编号',
        |prom_name STRING COMMENT '活动名称',
        |price_change_bill_no STRING COMMENT '变价单单号',
        |double_sale_flag STRING COMMENT '业绩双算标志',
        |check_user_no STRING COMMENT '发货人工号',
        |check_user STRING COMMENT '发货人',
        |chat_id STRING COMMENT '群ID',
        |community_operation STRING COMMENT '小程序分销员类型',
        |sys_source_name STRING COMMENT '小程序订单来源',
        |time_flag STRING COMMENT '非常规时间销售类型',
        |special_flag STRING COMMENT '团购单标识',
        |likespecial_flag STRING COMMENT '未打标团购',
        |special_white_flag STRING COMMENT '单会员批量购买',
        |mem_id STRING COMMENT '会员号',
        |change_start_time STRING COMMENT '变价单起始时间',
        |change_end_time STRING COMMENT '变价单结束时间',
        |unusual_sal_flag STRING COMMENT '非正常销售订单标识',
        |level_attr STRING COMMENT '消费时会员等级',
        |service_evaluation STRING COMMENT '服务评价',
        |service_star BIGINT COMMENT '星级',
        |tag_name STRING COMMENT '评价内容',
        |evaluation_date STRING COMMENT '评价日期',
        |shop_no STRING COMMENT '原销售店号',
        |shop_no_from STRING COMMENT '发货店号',
        |shop_name_from STRING COMMENT '发货店仓',
        |table_source SMALLINT COMMENT 'TABLE_SOURCE',
        |sales_date STRING COMMENT '原销售日期',
        |logistics_mode SMALLINT COMMENT '自提/快递',
        |distributor_flag STRING COMMENT '分销订单标志',
        |center_distributor_flag STRING COMMENT '中心客服标志',
        |is_online SMALLINT COMMENT '是否离店',
        |merchant_no STRING COMMENT 'MERCHANT_NO',
        |distributor_no STRING COMMENT '分销员编号',
        |distributor_employee_code STRING COMMENT '分销员工号',
        |distributor_employee_name STRING COMMENT '分销员',
        |distributor_shop_no STRING COMMENT '分销归属店号',
        |distributor_shop_name STRING COMMENT '分销归属店',
        |distributor_region_name STRING COMMENT '分销员地区',
        |distributor_big_region_name STRING COMMENT '分销员大区',
        |distributor_mp_name STRING COMMENT '分销员管理省区',
        |distributor_mc_name STRING COMMENT '分销员管理城市',
        |distributor_merchant_no STRING COMMENT '分销员业务类型',
        |distributor_employee_type STRING COMMENT '分销员类型',
        |distributor_store_main_brd_no STRING COMMENT '分销员主品牌',
        |distributor_department1 STRING COMMENT '分销归属部门',
        |distributor_department2 STRING COMMENT '分销归属组',
        |room_id BIGINT COMMENT '直播间ID',
        |express_no STRING COMMENT '快递单号',
        |logistics_name STRING COMMENT '快递公司',
        |actual_postage DECIMAL(18,4) COMMENT '运费',
        |stock_in_province STRING COMMENT '顾客收货省份',
        |stock_in_city STRING COMMENT '顾客收货城市',
        |sy_org_lno STRING COMMENT '业绩归属店号',
        |sy_flag STRING COMMENT '私域业绩分类',
        |merchant_name STRING COMMENT '业务类型名称',
        |member_join_chat_follow_nos_flag STRING COMMENT '群/好友订单标志',
        |private_member_join_chat_follow_nos_flag STRING COMMENT '私域群/好友订单标志',
        |member_shop_join_nos_flag STRING COMMENT '本店群/好友订单标志',
        |private_member_shop_join_nos_flag STRING COMMENT '本店私域群/好友订单标志',
        |follow_nos_flag STRING COMMENT '好友订单标志',
        |private_follow_nos_flag STRING COMMENT '私域好友订单标志',
        |platform_name STRING COMMENT '平台名称',
        |special_sell_flag STRING COMMENT '特卖类型',
        |sal_mode_cate STRING COMMENT '销售形式大类（常规销售、预售、发售、商场团购等）',
        |time_range STRING COMMENT '时段',
        |brd_season_stc STRING COMMENT '品牌季节结构',
        |brd_season_type_name STRING COMMENT '品牌季节类型',
        |brd_season_type_order STRING COMMENT '品牌季节类型排序',
        |lsg_mon_qty BIGINT COMMENT '上市月数',
        |brd_season_no STRING COMMENT '品牌季节编码',
        |brd_season_group STRING COMMENT '品牌季节组',
        |brd_season_group_order STRING COMMENT '品牌季节组排序',
        |etl_create_time STRING COMMENT 'ETL创建时间',
        |etl_update_time STRING COMMENT 'ETL更新时间',
        |ticket_buy_amt DECIMAL(18,4) COMMENT '券成本金额',
        |sal_cost_amt DECIMAL(18,4) COMMENT '销售成本额',
        |real_pay_time STRING COMMENT '真实支付时间',
        |commission_order_type STRING COMMENT '佣金订单类型',
        |online_offline_cate_name STRING COMMENT '线上线下',
        |online_offline_name_new STRING COMMENT '线上线下细类',
        |all_cate_name STRING COMMENT '全域分类',
        |sex SMALLINT COMMENT '会员性别',
        |abnormal_mem_type STRING COMMENT '异常会员类型',
        |black_type STRING COMMENT '拉黑类型',
        |white_type STRING COMMENT '白名单类型',
        |wholesale_type STRING COMMENT '团购客类型',
        |warning_times BIGINT COMMENT '预警次数',
        |mem_brd_no STRING COMMENT '会员业务分类编码',
        |mem_status STRING COMMENT '会员状态',
        |reg_source STRING COMMENT '注册来源',
        |reg_store STRING COMMENT '注册店铺',
        |reg_big_region_name STRING COMMENT '注册大区',
        |reg_region_name STRING COMMENT '注册地区',
        |reg_mp_name STRING COMMENT '注册省区',
        |reg_mc_name STRING COMMENT '注册管理城市',
        |reg_biz_city_name STRING COMMENT '注册经营城市',
        |reg_store_brd STRING COMMENT '注册店铺品牌',
        |reg_date STRING COMMENT '注册日期',
        |level_name STRING COMMENT '会员等级1',
        |paid_mem_level SMALLINT COMMENT '是否付费会员',
        |shop_name STRING COMMENT '原销售店',
        |is_online_name STRING COMMENT '是否离店',
        |employee_native_merchant_no STRING COMMENT '员工归属业务类型',
        |room_name STRING COMMENT '直播间',
        |live_anchor_name STRING COMMENT '主播姓名',
        |live_employee_no STRING COMMENT '主播工号',
        |live_share_img STRING COMMENT '直播间分享图',
        |live_brand_code STRING COMMENT '直播间归属品牌',
        |live_region_name STRING COMMENT '直播间归属地区',
        |live_shop_no STRING COMMENT '直播间归属店号',
        |live_shop_name STRING COMMENT '直播间归属店',
        |live_start_time STRING COMMENT '直播开始时间',
        |live_end_time STRING COMMENT '直播结束时间',
        |live_start_hour_name STRING COMMENT '直播开始时段',
        |distributor_retail_province_name STRING COMMENT '分销归属零售省区',
        |distributor_retail_director_code STRING COMMENT '分销归属零售主管编码',
        |distributor_retail_director_name STRING COMMENT '分销归属零售主管',
        |distributor_retail_manager_code STRING COMMENT '分销归属零售经理编码',
        |distributor_retail_manager_name STRING COMMENT '分销归属零售经理',
        |native_distributor_flag STRING COMMENT '本店员工分销标志',
        |sy_org_name STRING COMMENT '业绩归属店',
        |nos_discount DECIMAL(18,4) COMMENT '单品销售折扣',
        |period_date STRING COMMENT '日期',
        |fin_year STRING COMMENT '财年',
        |fin_qtr SMALLINT COMMENT '财年季度',
        |year_week INT COMMENT '年周',
        |year_month STRING COMMENT '年月',
        |weekend STRING COMMENT '周末',
        |nl_holiday STRING COMMENT '农历节假日',
        |nl_sdate STRING COMMENT '农历日期',
        |brd_group_name STRING COMMENT '品牌组名称',
        |brd_group_order INT COMMENT '品牌组排序',
        |brd_abbr STRING COMMENT '品牌部简称',
        |brd_cname STRING COMMENT '品牌部中文名称',
        |brd_order SMALLINT COMMENT '品牌部排序',
        |brd_dtl_abbr STRING COMMENT '品牌简称',
        |brd_dtl_ename STRING COMMENT '品牌英文名',
        |pro_code STRING COMMENT '产品货号',
        |pro_name STRING COMMENT '产品名称',
        |pic_url STRING COMMENT '产品图片',
        |brd_season_name STRING COMMENT '品牌季节',
        |brd_season_order SMALLINT COMMENT '品牌季节排序',
        |brd_pro_season STRING COMMENT '产品季',
        |lsg_day STRING COMMENT '上市日',
        |lsg_month STRING COMMENT '上市月',
        |lsg_year STRING COMMENT '上市年',
        |pro_cate_name STRING COMMENT '产品大类',
        |pro_cate_order SMALLINT COMMENT '产品大类排序',
        |nba_logo STRING COMMENT 'NBA标志',
        |pro_down_name STRING COMMENT '上下装',
        |pro_length_name STRING COMMENT '长短装',
        |pro_series_name1 STRING COMMENT '常规系列',
        |pro_series_name2 STRING COMMENT '功能系列',
        |pro_series_name3 STRING COMMENT '故事系列',
        |pro_gender_name STRING COMMENT '性别',
        |pro_prm DECIMAL(18,4) COMMENT '牌价',
        |pro_prm_range STRING COMMENT '价格带',
        |pro_repeat_lsg STRING COMMENT '重复上市',
        |qs_level STRING COMMENT 'QS等级',
        |pro_style_name STRING COMMENT '款式',
        |pro_sub_style_name STRING COMMENT '细款',
        |pro_brd_style_name STRING COMMENT '品牌款式名称',
        |pro_repeat_season STRING COMMENT '重复季节',
        |brd_channel STRING COMMENT '品牌渠道标识',
        |pro_brd STRING COMMENT '产品品牌',
        |age_segment STRING COMMENT '产品年龄段',
        |latest_order_season STRING COMMENT '最新订货季节',
        |m_brd_season_name STRING COMMENT '全品牌品牌季节',
        |m_brd_season_order SMALLINT COMMENT '全品牌品牌季节排序',
        |m_pro_cate_name STRING COMMENT '全品牌产品大类',
        |m_pro_cate_order SMALLINT COMMENT '全品牌产品大类排序',
        |m_pro_down_name STRING COMMENT '全品牌上下装',
        |m_pro_gender_name STRING COMMENT '全品牌性别',
        |m_pro_length_name STRING COMMENT '全品牌长短装',
        |m_pro_series_name1 STRING COMMENT '全品牌常规系列',
        |m_pro_style_name STRING COMMENT '全品牌款式',
        |m_pro_sub_style_name STRING COMMENT '全品牌细款',
        |nk_cate STRING COMMENT 'NK类别',
        |offering_date STRING COMMENT '发售日期',
        |plate_code STRING COMMENT '版单号',
        |pro_biz_brd STRING COMMENT '业务品牌',
        |pro_brd_section2 STRING COMMENT '品牌类型2',
        |pro_buying_type STRING COMMENT '买货类型',
        |pro_cate_flag STRING COMMENT '物料标志',
        |pro_channel STRING COMMENT '产品渠道',
        |pro_channel_supply STRING COMMENT '渠道专供',
        |pro_chinese_subject STRING COMMENT '中文主题',
        |pro_core_models STRING COMMENT '核心款',
        |pro_distri STRING COMMENT '分配必定',
        |pro_event_subdivision STRING COMMENT '项目细分',
        |pro_evergreen STRING COMMENT '常青款',
        |pro_fabric_tech STRING COMMENT '面料科技',
        |pro_form STRING COMMENT '风格',
        |pro_function STRING COMMENT '功能作用',
        |pro_goods_nature STRING COMMENT '货品性质',
        |pro_main_color STRING COMMENT '产品主色',
        |pro_deputy_color STRING COMMENT '产品副色',
        |pro_mt_gender STRING COMMENT '多品性别',
        |pro_mt_season STRING COMMENT '多品季节',
        |pro_mt_style STRING COMMENT 'mt款式',
        |pro_national_team STRING COMMENT '国家队',
        |ballstar STRING COMMENT '球星',
        |ballteam STRING COMMENT '球队',
        |pro_pop STRING COMMENT 'pop',
        |pro_season STRING COMMENT '季节',
        |pro_shoes_style STRING COMMENT '鞋型1',
        |pro_shoes_style2 STRING COMMENT '鞋型2',
        |size_type_code STRING COMMENT '尺寸类型编码',
        |size_type_name STRING COMMENT '尺寸类型',
        |size_segment STRING COMMENT '尺码段',
        |storage_type STRING COMMENT '存储类型',
        |pro_sport_event STRING COMMENT '运动项目',
        |pro_supplement STRING COMMENT '补充线',
        |pro_support STRING COMMENT '市场支持',
        |pro_support_style STRING COMMENT '支持类型',
        |pro_support_style2 STRING COMMENT '支持类型2',
        |pro_tech STRING COMMENT '科技',
        |pro_type STRING COMMENT '版型',
        |org_new_no STRING COMMENT '机构最新编码',
        |org_name STRING COMMENT '机构名称',
        |big_region_name STRING COMMENT '大区',
        |big_region_order SMALLINT COMMENT '大区排序',
        |region_no STRING COMMENT '地区编码',
        |region_name STRING COMMENT '地区',
        |region_order SMALLINT COMMENT '地区排序',
        |mp_name STRING COMMENT '省区',
        |mc_name STRING COMMENT '管理城市',
        |biz_city_name STRING COMMENT '经营城市',
        |part_area_name STRING COMMENT '片区',
        |province_no STRING COMMENT '行政省编码',
        |province_name STRING COMMENT '行政省',
        |city_name STRING COMMENT '行政市',
        |county_name STRING COMMENT '行政县',
        |store_visualize STRING COMMENT '店铺形象',
        |store_channel STRING COMMENT '店铺渠道',
        |store_level_name STRING COMMENT '店铺级别',
        |multi_type STRING COMMENT '多品类型',
        |biz_attr_no STRING COMMENT '经营属性编码',
        |biz_attr_name STRING COMMENT '经营属性',
        |biz_attr_order SMALLINT COMMENT '经营属性排序',
        |biz_attr_no2 STRING COMMENT '经营大类编码',
        |biz_attr_name2 STRING COMMENT '经营大类',
        |biz_attr_order2 SMALLINT COMMENT '经营大类排序',
        |store_brd_flag STRING COMMENT '主寄卖',
        |key_store STRING COMMENT '重点店铺',
        |type_level STRING COMMENT '类型级别',
        |store_brd STRING COMMENT '店铺品牌',
        |org_flag STRING COMMENT '机构标志',
        |retail_director_code STRING COMMENT '多门店负责人工号',
        |retail_director_name STRING COMMENT '多门店负责人姓名',
        |retail_manager_code STRING COMMENT '零售负责人工号',
        |retail_manager_name STRING COMMENT '零售负责人姓名',
        |vsr_director_code STRING COMMENT '门店陈列师工号',
        |vsr_director_name STRING COMMENT '门店陈列师姓名',
        |vsr_manager_code STRING COMMENT '陈列专家工号',
        |vsr_manager_name STRING COMMENT '陈列专家姓名',
        |train_director_code STRING COMMENT '培训主管工号',
        |train_director_name STRING COMMENT '培训主管姓名',
        |train_manager_code STRING COMMENT '培训经理工号',
        |train_manager_name STRING COMMENT '培训经理姓名',
        |onlineop_director_code STRING COMMENT '线上运营主管工号',
        |onlineop_director_name STRING COMMENT '线上运营主管姓名',
        |onlineop_manager_code STRING COMMENT '线上运营经理工号',
        |onlineop_manager_name STRING COMMENT '线上运营经理姓名',
        |store_abbr STRING COMMENT '机构简称',
        |self_checking_mode STRING COMMENT '自收银模式',
        |biz_attr_name3 STRING COMMENT '经营细类',
        |brd_flag STRING COMMENT '品牌标识',
        |brd_store_no STRING COMMENT '品牌店号',
        |store_status STRING COMMENT '店铺状态',
        |order_unit_no STRING COMMENT '货管单位编码',
        |order_unit_name STRING COMMENT '货管单位名称',
        |retail_province_name STRING COMMENT '零售省区',
        |store_name STRING COMMENT '店仓名称',
        |internal_channel STRING COMMENT '内部渠道',
        |store_flag STRING COMMENT '店仓标志',
        |level_no STRING COMMENT '城市级别',
        |property_cooperation_cond STRING COMMENT '物业合作条件',
        |settlement_mth STRING COMMENT '结算方式',
        |store_channel_name2 STRING COMMENT '销售渠道2',
        |user_channel STRING COMMENT '对接类别',
        |org_lno2 STRING COMMENT '机构编码2',
        |mall_name STRING COMMENT '商场',
        |biz_group_name STRING COMMENT '商业集团',
        |store_type_name STRING COMMENT '店铺类型',
        |ma_name STRING COMMENT '管理区域',
        |biz_circle_name STRING COMMENT '商圈',
        |open_date STRING COMMENT '开店日',
        |close_date STRING COMMENT '关店日',
        |point_store STRING COMMENT '是否指数店',
        |area_total DECIMAL(18,4) COMMENT '总面积',
        |biz_area DECIMAL(18,4) COMMENT '营业面积',
        |tel STRING COMMENT '电话',
        |cman_addr STRING COMMENT '地址',
        |strategic_positioning STRING COMMENT '战略定位',
        |cust_store STRING COMMENT '客流店铺',
        |is_large_org STRING COMMENT '大店标志',
        |latest_renewal_time STRING COMMENT '最新改造日期',
        |store_latitude STRING COMMENT '纬度',
        |store_longitude STRING COMMENT '经度',
        |send_big_region_name STRING COMMENT '发货大区',
        |send_region_name STRING COMMENT '发货地区',
        |virtual_big_region_name STRING COMMENT '虚店大区',
        |virtual_region_name STRING COMMENT '虚店地区',
        |virtual_mc_name STRING COMMENT '虚店管理城市',
        |is_waidan STRING COMMENT '是否外单扫描店铺',
        |sal_mode_name STRING COMMENT '销售形式',
        |sal_mode_cate_name STRING COMMENT '销售形式大类',
        |sy_region_name STRING COMMENT '业绩归属地区',
        |sy_big_region_name STRING COMMENT '业绩归属大区',
        |sy_mp_name STRING COMMENT '业绩归属管理省区',
        |sy_mc_name STRING COMMENT '业绩归属管理城市',
        |online_offline_name STRING COMMENT '原线上线下',
        |m_brd_season_name_attr STRING COMMENT '历史全品牌品牌季节名称',
        |size_order STRING COMMENT '尺寸排序',
        |amt_target DECIMAL(18,4) COMMENT '营业目标',
        |gwp_flag STRING COMMENT 'GWP标签',
        |all_sal_amt DECIMAL(18,4) COMMENT '整单销售额',
        |all_sal_qty BIGINT COMMENT '整单销售量',
        |shop_mode_name STRING COMMENT '私域店铺类型' )
        |USING parquet
        |PARTITIONED BY (p_mon STRING COMMENT 'yyyymm' )
      """.stripMargin)

    sql(
      """
        |CREATE TABLE ads_fact_pos_ord_analysis_r (
        |period_sdate STRING COMMENT '字符串日期',
        |qs_level_attr STRING COMMENT 'QS等级日变化',
        |pro_no STRING COMMENT '产品编码',
        |size_code STRING COMMENT '尺码',
        |brd_dtl_no STRING COMMENT '品牌编码',
        |brd_no STRING COMMENT '品牌部编码',
        |org_lno STRING COMMENT '机构原编码',
        |store_lno STRING COMMENT '店仓原编码',
        |online_offline SMALLINT COMMENT '原线上线下',
        |order_no STRING COMMENT '订单编号',
        |order_dtl_id STRING COMMENT '订单明细ID',
        |ref_bill_no STRING COMMENT '相关单号',
        |main_order_no STRING COMMENT 'MAIN_ORDER_NO',
        |third_order_no STRING COMMENT '第三方订单号',
        |yougou_order_dtl_id STRING COMMENT '优购订单明细ID',
        |order_type STRING COMMENT '退换货类型',
        |old_order_no STRING COMMENT '退换货原订单编号',
        |old_order_dtl_id STRING COMMENT '退换货原订单明细ID',
        |is_new_no SMALLINT COMMENT '新旧货编码',
        |is_new_name STRING COMMENT '新旧货',
        |virtual_activity_flag STRING COMMENT '是否虚活动',
        |sal_qty BIGINT COMMENT '销售量',
        |sal_amt DECIMAL(18,4) COMMENT '销售额',
        |sal_nos_prm_amt DECIMAL(18,4) COMMENT '销售单据牌价额',
        |sal_prm_amt DECIMAL(18,4) COMMENT '销售牌价额',
        |wl_sal_qty BIGINT COMMENT '销售量（含物料）',
        |wl_sal_amt DECIMAL(18,4) COMMENT '销售额（含物料）',
        |wl_sal_nos_prm_amt DECIMAL(18,4) COMMENT '销售单据牌价额（含物料）',
        |wl_sal_prm_amt DECIMAL(18,4) COMMENT '销售牌价额（含物料）',
        |surplus_amount DECIMAL(18,4) COMMENT '用券金额(优惠券价值)',
        |prom_sal_amt DECIMAL(18,4) COMMENT '促销销售额',
        |prom_sal_qty BIGINT COMMENT '促销销售量',
        |prom_sal_nos_prm_amt DECIMAL(18,4) COMMENT '促销销售单据牌价额',
        |customer_settle_amt DECIMAL(18,4) COMMENT '顾客成交金额',
        |customer_settle_price DECIMAL(18,4) COMMENT '顾客结算价格',
        |ticket_settle_price DECIMAL(18,4) COMMENT '券后结算价格',
        |ticket_settle_amt DECIMAL(18,4) COMMENT '券后结算金额',
        |cost_score DECIMAL(18,4) COMMENT '积分抵用额',
        |base_score DECIMAL(18,4) COMMENT '赠送积分',
        |sal_qty_sy BIGINT COMMENT '业绩量',
        |sal_amt_sy DECIMAL(18,4) COMMENT '业绩额',
        |sal_nos_prm_amt_sy DECIMAL(18,4) COMMENT '业绩单据牌价额',
        |sal_prm_amt_sy DECIMAL(18,4) COMMENT '业绩牌价额',
        |sy_send_qty BIGINT COMMENT '双算发货量',
        |sy_send_amt DECIMAL(18,4) COMMENT '双算发货额',
        |sy_send_nos_prm_amt DECIMAL(18,4) COMMENT '双算发货单据牌价额',
        |sy_send_prm_amt DECIMAL(18,4) COMMENT '双算发货牌价额',
        |discount_rate DECIMAL(18,4) COMMENT '结算对应扣率',
        |discount_amt DECIMAL(18,4) COMMENT '扣费',
        |rebate_amount DECIMAL(18,4) COMMENT '外卡抵用额',
        |sale_price DECIMAL(18,4) COMMENT '现价',
        |area_disc_rate DECIMAL(18,4) COMMENT '地区折扣底线',
        |country_disc_rate DECIMAL(18,4) COMMENT '全国折扣底线',
        |across_flag STRING COMMENT '跨店标识',
        |live_flag STRING COMMENT '直播标志',
        |ticket_no STRING COMMENT '券号，多个券逗号隔开',
        |ticket_name STRING COMMENT '券名称，多个券逗号隔开',
        |pay_way STRING COMMENT '支付方式，多个方式逗号隔开',
        |ticket_expense DECIMAL(18,4) COMMENT '用户运营部承担券抵扣金额',
        |ticket_discount DECIMAL(18,4) COMMENT '品牌部承担券抵扣金额',
        |dy_plat_surplus_amount DECIMAL(18,4) COMMENT '抖音平台优惠金额',
        |enter_store_qty BIGINT COMMENT '进店人数',
        |cust_flow_flag SMALLINT COMMENT '有客流订单标志',
        |balance_qty BIGINT COMMENT '实物存',
        |balance_prm_amt DECIMAL(18,4) COMMENT '实物存牌价额',
        |total_inv_qty BIGINT COMMENT '总库存量',
        |total_inv_prm_amt DECIMAL(18,4) COMMENT '总库存牌价额',
        |biz_inv_qty BIGINT COMMENT '业务存量',
        |biz_inv_prm_amt DECIMAL(18,4) COMMENT '业务存牌价额',
        |total_transit_in_qty BIGINT COMMENT '区内入在途量',
        |total_transit_in_amt DECIMAL(18,4) COMMENT '区内入在途额',
        |total_transit_in_account_qty BIGINT COMMENT '跨区入在途量',
        |total_transit_in_account_amt DECIMAL(18,4) COMMENT '跨区入在途额',
        |total_bad_transit_in_qty BIGINT COMMENT '次品区内入在途量',
        |total_bad_transit_in_amt DECIMAL(18,4) COMMENT '次品区内入在途牌价额',
        |total_bad_transit_in_account_qty BIGINT COMMENT '次品跨区入在途量',
        |total_bad_transit_in_account_amt DECIMAL(18,4) COMMENT '次品跨区入在途牌价额',
        |total_factory_in_qty BIGINT COMMENT '采购入在途量',
        |total_factory_in_amt DECIMAL(18,4) COMMENT '采购入在途额',
        |online_sal_inv BIGINT COMMENT '线上可售库存量',
        |online_sal_amt DECIMAL(18,4) COMMENT '线上可售库存牌价额',
        |offline_sal_inv BIGINT COMMENT '线下可售库存量',
        |offline_sal_amt DECIMAL(18,4) COMMENT '线下可售库存牌价额',
        |lock_qty BIGINT COMMENT '冻结库存量',
        |lock_amt DECIMAL(18,4) COMMENT '冻结库存牌价额',
        |occupied_qty BIGINT COMMENT '预占库存数量',
        |occupied_amt DECIMAL(18,4) COMMENT '预占库存库存额',
        |backup_qty BIGINT COMMENT '备货预占数量',
        |backup_amt DECIMAL(18,4) COMMENT '备货预占库存额',
        |work_qty BIGINT COMMENT '工服库存量',
        |work_amt DECIMAL(18,4) COMMENT '工服库存牌价额',
        |un_schedule_qty BIGINT COMMENT '不可调度数量',
        |un_schedule_amt DECIMAL(18,4) COMMENT '不可调度库存额',
        |un_share_qty BIGINT COMMENT '不可共享数量',
        |un_share_amt DECIMAL(18,4) COMMENT '不可共享牌价额',
        |third_one_level_channel_name STRING COMMENT '一级来源',
        |third_one_level_channel_no STRING COMMENT '第三方一级渠道编码',
        |third_two_level_channel_name STRING COMMENT '二级来源',
        |third_two_level_channel_no STRING COMMENT '第三方二级渠道编码',
        |third_three_level_channel_name STRING COMMENT '三级来源',
        |third_three_level_channel_no STRING COMMENT '第三方三级渠道编码',
        |order_source SMALLINT COMMENT '单据来源',
        |pay_name STRING COMMENT '支付方式',
        |status STRING COMMENT '单据状态',
        |pickup_date STRING COMMENT '提货日期',
        |adjust_flag STRING COMMENT '改单类型',
        |pay_time STRING COMMENT '订单的支付时间',
        |asst_no STRING COMMENT '营业员工号',
        |asst_name STRING COMMENT '营业员姓名',
        |pro_name_app STRING COMMENT '活动别名',
        |prom_channel STRING COMMENT '活动渠道',
        |rate_style STRING COMMENT '扣率',
        |prom_source STRING COMMENT '活动来源',
        |prom_start_time STRING COMMENT '促销活动起始日期',
        |prom_end_time STRING COMMENT '促销活动终止日期',
        |template_no STRING COMMENT '促销模板编号',
        |template_type STRING COMMENT '促销活动模板类型',
        |batch_no STRING COMMENT '活动批次号',
        |batch_name STRING COMMENT '活动批次',
        |prom_no STRING COMMENT '活动编号',
        |prom_name STRING COMMENT '活动名称',
        |price_change_bill_no STRING COMMENT '变价单单号',
        |double_sale_flag STRING COMMENT '业绩双算标志',
        |check_user_no STRING COMMENT '发货人工号',
        |check_user STRING COMMENT '发货人',
        |chat_id STRING COMMENT '群ID',
        |community_operation STRING COMMENT '分销员类型',
        |sys_source_name STRING COMMENT '小程序订单来源',
        |time_flag STRING COMMENT '非常规时间销售类型',
        |special_flag STRING COMMENT '团购单标识',
        |likespecial_flag STRING COMMENT '未打标团购',
        |special_white_flag STRING COMMENT '单会员批量购买',
        |mem_id STRING COMMENT '会员号',
        |change_start_time STRING COMMENT '变价单起始时间',
        |change_end_time STRING COMMENT '变价单结束时间',
        |unusual_sal_flag STRING COMMENT '非正常销售订单标识',
        |level_attr STRING COMMENT '消费时会员等级',
        |service_evaluation STRING COMMENT '服务评价',
        |service_star BIGINT COMMENT '星级',
        |tag_name STRING COMMENT '评价内容',
        |evaluation_date STRING COMMENT '评价日期',
        |shop_no STRING COMMENT '原销售店号',
        |shop_no_from STRING COMMENT '发货店号',
        |shop_name_from STRING COMMENT '发货店仓',
        |table_source SMALLINT COMMENT 'TABLE_SOURCE',
        |sales_date STRING COMMENT '原销售日期',
        |logistics_mode SMALLINT COMMENT '自提/快递',
        |distributor_flag STRING COMMENT '分销订单标志',
        |center_distributor_flag STRING COMMENT '中心客服标志',
        |is_online SMALLINT COMMENT '是否离店',
        |merchant_no STRING COMMENT 'MERCHANT_NO',
        |distributor_no STRING COMMENT '分销员编号',
        |distributor_employee_code STRING COMMENT '分销员工号',
        |distributor_employee_name STRING COMMENT '分销员',
        |distributor_shop_no STRING COMMENT '分销归属店号',
        |distributor_shop_name STRING COMMENT '分销归属店',
        |distributor_region_name STRING COMMENT '分销员地区',
        |distributor_big_region_name STRING COMMENT '分销员大区',
        |distributor_mp_name STRING COMMENT '分销员管理省区',
        |distributor_mc_name STRING COMMENT '分销员管理城市',
        |distributor_merchant_no STRING COMMENT '分销员业务类型',
        |distributor_employee_type STRING COMMENT '分销员类型',
        |distributor_store_main_brd_no STRING COMMENT '分销员主品牌',
        |distributor_department1 STRING COMMENT '分销归属部门',
        |distributor_department2 STRING COMMENT '分销归属组',
        |room_id BIGINT COMMENT '直播间ID',
        |express_no STRING COMMENT '快递单号',
        |logistics_name STRING COMMENT '快递公司',
        |actual_postage DECIMAL(18,4) COMMENT '运费',
        |stock_in_province STRING COMMENT '顾客收货省份',
        |stock_in_city STRING COMMENT '顾客收货城市',
        |sy_org_lno STRING COMMENT '业绩归属店号',
        |sy_flag STRING COMMENT '私域业绩分类',
        |merchant_name STRING COMMENT '业务类型名称',
        |member_join_chat_follow_nos_flag STRING COMMENT '群/好友订单标志',
        |private_member_join_chat_follow_nos_flag STRING COMMENT '私域群/好友订单标志',
        |member_shop_join_nos_flag STRING COMMENT '本店群/好友订单标志',
        |private_member_shop_join_nos_flag STRING COMMENT '本店私域群/好友订单标志',
        |follow_nos_flag STRING COMMENT '好友订单标志',
        |private_follow_nos_flag STRING COMMENT '私域好友订单标志',
        |platform_name STRING COMMENT '平台名称',
        |special_sell_flag STRING COMMENT '特卖类型',
        |sal_mode_cate STRING COMMENT '销售形式大类（常规销售、预售、发售、商场团购等）',
        |time_range STRING COMMENT '时段',
        |brd_season_stc STRING COMMENT '品牌季节结构',
        |brd_season_type_name STRING COMMENT '品牌季节类型',
        |brd_season_type_order STRING COMMENT '品牌季节类型排序',
        |lsg_mon_qty BIGINT COMMENT '上市月数',
        |brd_season_no STRING COMMENT '品牌季节编码',
        |brd_season_group STRING COMMENT '品牌季节组',
        |brd_season_group_order STRING COMMENT '品牌季节组排序',
        |etl_create_time STRING COMMENT 'ETL创建时间',
        |etl_update_time STRING COMMENT 'ETL更新时间',
        |ticket_buy_amt DECIMAL(18,4) COMMENT '券成本金额',
        |sal_cost_amt DECIMAL(18,4) COMMENT '销售成本额',
        |real_pay_time STRING COMMENT '真实支付时间',
        |commission_order_type STRING COMMENT '佣金订单类型',
        |online_offline_cate_name STRING COMMENT '线上线下',
        |online_offline_name_new STRING COMMENT '线上线下细类',
        |all_cate_name STRING COMMENT '全域分类',
        |sex SMALLINT COMMENT '会员性别',
        |abnormal_mem_type STRING COMMENT '异常会员类型',
        |black_type STRING COMMENT '拉黑类型',
        |white_type STRING COMMENT '白名单类型',
        |wholesale_type STRING COMMENT '团购客类型',
        |warning_times BIGINT COMMENT '预警次数',
        |mem_brd_no STRING COMMENT '会员业务分类编码',
        |mem_status STRING COMMENT '会员状态',
        |reg_source STRING COMMENT '注册来源',
        |reg_store STRING COMMENT '注册店铺',
        |reg_big_region_name STRING COMMENT '注册大区',
        |reg_region_name STRING COMMENT '注册地区',
        |reg_mp_name STRING COMMENT '注册省区',
        |reg_mc_name STRING COMMENT '注册管理城市',
        |reg_biz_city_name STRING COMMENT '注册经营城市',
        |reg_store_brd STRING COMMENT '注册店铺品牌',
        |reg_date STRING COMMENT '注册日期',
        |level_name STRING COMMENT '会员等级1',
        |paid_mem_level SMALLINT COMMENT '是否付费会员',
        |shop_name STRING COMMENT '原销售店',
        |is_online_name STRING COMMENT '是否离店',
        |employee_native_merchant_no STRING COMMENT '员工归属业务类型',
        |room_name STRING COMMENT '直播间',
        |live_anchor_name STRING COMMENT '主播姓名',
        |live_employee_no STRING COMMENT '主播工号',
        |live_share_img STRING COMMENT '直播间分享图',
        |live_brand_code STRING COMMENT '直播间归属品牌',
        |live_region_name STRING COMMENT '直播间归属地区',
        |live_shop_no STRING COMMENT '直播间归属店号',
        |live_shop_name STRING COMMENT '直播间归属店',
        |live_start_time STRING COMMENT '直播开始时间',
        |live_end_time STRING COMMENT '直播结束时间',
        |live_start_hour_name STRING COMMENT '直播开始时段',
        |distributor_retail_province_name STRING COMMENT '分销归属零售省区',
        |distributor_retail_director_code STRING COMMENT '分销归属零售主管编码',
        |distributor_retail_director_name STRING COMMENT '分销归属零售主管',
        |distributor_retail_manager_code STRING COMMENT '分销归属零售经理编码',
        |distributor_retail_manager_name STRING COMMENT '分销归属零售经理',
        |native_distributor_flag STRING COMMENT '本店员工分销标志',
        |sy_org_name STRING COMMENT '业绩归属店',
        |nos_discount DECIMAL(18,4) COMMENT '单品销售折扣',
        |period_date STRING COMMENT '日期',
        |fin_year STRING COMMENT '财年',
        |fin_qtr SMALLINT COMMENT '财年季度',
        |year_week INT COMMENT '年周',
        |year_month STRING COMMENT '年月',
        |weekend STRING COMMENT '周末',
        |nl_holiday STRING COMMENT '农历节假日',
        |nl_sdate STRING COMMENT '农历日期',
        |brd_group_name STRING COMMENT '品牌组名称',
        |brd_group_order INT COMMENT '品牌组排序',
        |brd_abbr STRING COMMENT '品牌部简称',
        |brd_cname STRING COMMENT '品牌部中文名称',
        |brd_order SMALLINT COMMENT '品牌部排序',
        |brd_dtl_abbr STRING COMMENT '品牌简称',
        |brd_dtl_ename STRING COMMENT '品牌英文名',
        |pro_code STRING COMMENT '产品货号',
        |pro_name STRING COMMENT '产品名称',
        |pic_url STRING COMMENT '产品图片',
        |brd_season_name STRING COMMENT '品牌季节',
        |brd_season_order SMALLINT COMMENT '品牌季节排序',
        |brd_pro_season STRING COMMENT '产品季',
        |lsg_day STRING COMMENT '上市日',
        |lsg_month STRING COMMENT '上市月',
        |lsg_year STRING COMMENT '上市年',
        |pro_cate_name STRING COMMENT '产品大类',
        |pro_cate_order SMALLINT COMMENT '产品大类排序',
        |nba_logo STRING COMMENT 'NBA标志',
        |pro_down_name STRING COMMENT '上下装',
        |pro_length_name STRING COMMENT '长短装',
        |pro_series_name1 STRING COMMENT '常规系列',
        |pro_series_name2 STRING COMMENT '功能系列',
        |pro_series_name3 STRING COMMENT '故事系列',
        |pro_gender_name STRING COMMENT '性别',
        |pro_prm DECIMAL(18,4) COMMENT '牌价',
        |pro_prm_range STRING COMMENT '价格带',
        |pro_repeat_lsg STRING COMMENT '重复上市',
        |qs_level STRING COMMENT 'QS等级',
        |pro_style_name STRING COMMENT '款式',
        |pro_sub_style_name STRING COMMENT '细款',
        |pro_brd_style_name STRING COMMENT '品牌款式名称',
        |pro_repeat_season STRING COMMENT '重复季节',
        |brd_channel STRING COMMENT '品牌渠道标识',
        |pro_brd STRING COMMENT '产品品牌',
        |age_segment STRING COMMENT '产品年龄段',
        |latest_order_season STRING COMMENT '最新订货季节',
        |m_brd_season_name STRING COMMENT '全品牌品牌季节',
        |m_brd_season_order SMALLINT COMMENT '全品牌品牌季节排序',
        |m_pro_cate_name STRING COMMENT '全品牌产品大类',
        |m_pro_cate_order SMALLINT COMMENT '全品牌产品大类排序',
        |m_pro_down_name STRING COMMENT '全品牌上下装',
        |m_pro_gender_name STRING COMMENT '全品牌性别',
        |m_pro_length_name STRING COMMENT '全品牌长短装',
        |m_pro_series_name1 STRING COMMENT '全品牌常规系列',
        |m_pro_style_name STRING COMMENT '全品牌款式',
        |m_pro_sub_style_name STRING COMMENT '全品牌细款',
        |nk_cate STRING COMMENT 'NK类别',
        |offering_date STRING COMMENT '发售日期',
        |plate_code STRING COMMENT '版单号',
        |pro_biz_brd STRING COMMENT '业务品牌',
        |pro_brd_section2 STRING COMMENT '品牌类型2',
        |pro_buying_type STRING COMMENT '买货类型',
        |pro_cate_flag STRING COMMENT '物料标志',
        |pro_channel STRING COMMENT '产品渠道',
        |pro_channel_supply STRING COMMENT '渠道专供',
        |pro_chinese_subject STRING COMMENT '中文主题',
        |pro_core_models STRING COMMENT '核心款',
        |pro_distri STRING COMMENT '分配必定',
        |pro_event_subdivision STRING COMMENT '项目细分',
        |pro_evergreen STRING COMMENT '常青款',
        |pro_fabric_tech STRING COMMENT '面料科技',
        |pro_form STRING COMMENT '风格',
        |pro_function STRING COMMENT '功能作用',
        |pro_goods_nature STRING COMMENT '货品性质',
        |pro_main_color STRING COMMENT '产品主色',
        |pro_deputy_color STRING COMMENT '产品副色',
        |pro_mt_gender STRING COMMENT '多品性别',
        |pro_mt_season STRING COMMENT '多品季节',
        |pro_mt_style STRING COMMENT 'mt款式',
        |pro_national_team STRING COMMENT '国家队',
        |ballstar STRING COMMENT '球星',
        |ballteam STRING COMMENT '球队',
        |pro_pop STRING COMMENT 'pop',
        |pro_season STRING COMMENT '季节',
        |pro_shoes_style STRING COMMENT '鞋型1',
        |pro_shoes_style2 STRING COMMENT '鞋型2',
        |size_type_code STRING COMMENT '尺寸类型编码',
        |size_type_name STRING COMMENT '尺寸类型',
        |size_segment STRING COMMENT '尺码段',
        |storage_type STRING COMMENT '存储类型',
        |pro_sport_event STRING COMMENT '运动项目',
        |pro_supplement STRING COMMENT '补充线',
        |pro_support STRING COMMENT '市场支持',
        |pro_support_style STRING COMMENT '支持类型',
        |pro_support_style2 STRING COMMENT '支持类型2',
        |pro_tech STRING COMMENT '科技',
        |pro_type STRING COMMENT '版型',
        |org_new_no STRING COMMENT '机构最新编码',
        |org_name STRING COMMENT '机构名称',
        |big_region_name STRING COMMENT '大区',
        |big_region_order SMALLINT COMMENT '大区排序',
        |region_no STRING COMMENT '地区编码',
        |region_name STRING COMMENT '地区',
        |region_order SMALLINT COMMENT '地区排序',
        |mp_name STRING COMMENT '省区',
        |mc_name STRING COMMENT '管理城市',
        |biz_city_name STRING COMMENT '经营城市',
        |part_area_name STRING COMMENT '片区',
        |province_no STRING COMMENT '行政省编码',
        |province_name STRING COMMENT '行政省',
        |city_name STRING COMMENT '行政市',
        |county_name STRING COMMENT '行政县',
        |store_visualize STRING COMMENT '店铺形象',
        |store_channel STRING COMMENT '店铺渠道',
        |store_level_name STRING COMMENT '店铺级别',
        |multi_type STRING COMMENT '多品类型',
        |biz_attr_no STRING COMMENT '经营属性编码',
        |biz_attr_name STRING COMMENT '经营属性',
        |biz_attr_order SMALLINT COMMENT '经营属性排序',
        |biz_attr_no2 STRING COMMENT '经营大类编码',
        |biz_attr_name2 STRING COMMENT '经营大类',
        |biz_attr_order2 SMALLINT COMMENT '经营大类排序',
        |store_brd_flag STRING COMMENT '主寄卖',
        |key_store STRING COMMENT '重点店铺',
        |type_level STRING COMMENT '类型级别',
        |store_brd STRING COMMENT '店铺品牌',
        |org_flag STRING COMMENT '机构标志',
        |retail_director_code STRING COMMENT '多门店负责人工号',
        |retail_director_name STRING COMMENT '多门店负责人姓名',
        |retail_manager_code STRING COMMENT '零售负责人工号',
        |retail_manager_name STRING COMMENT '零售负责人姓名',
        |vsr_director_code STRING COMMENT '门店陈列师工号',
        |vsr_director_name STRING COMMENT '门店陈列师姓名',
        |vsr_manager_code STRING COMMENT '陈列专家工号',
        |vsr_manager_name STRING COMMENT '陈列专家姓名',
        |train_director_code STRING COMMENT '培训主管工号',
        |train_director_name STRING COMMENT '培训主管姓名',
        |train_manager_code STRING COMMENT '培训经理工号',
        |train_manager_name STRING COMMENT '培训经理姓名',
        |onlineop_director_code STRING COMMENT '线上运营主管工号',
        |onlineop_director_name STRING COMMENT '线上运营主管姓名',
        |onlineop_manager_code STRING COMMENT '线上运营经理工号',
        |onlineop_manager_name STRING COMMENT '线上运营经理姓名',
        |store_abbr STRING COMMENT '机构简称',
        |self_checking_mode STRING COMMENT '自收银模式',
        |biz_attr_name3 STRING COMMENT '经营细类',
        |brd_flag STRING COMMENT '品牌标识',
        |brd_store_no STRING COMMENT '品牌店号',
        |store_status STRING COMMENT '店铺状态',
        |order_unit_no STRING COMMENT '货管单位编码',
        |order_unit_name STRING COMMENT '货管单位名称',
        |retail_province_name STRING COMMENT '零售省区',
        |store_name STRING COMMENT '店仓名称',
        |internal_channel STRING COMMENT '内部渠道',
        |store_flag STRING COMMENT '店仓标志',
        |level_no STRING COMMENT '城市级别',
        |property_cooperation_cond STRING COMMENT '物业合作条件',
        |settlement_mth STRING COMMENT '结算方式',
        |store_channel_name2 STRING COMMENT '销售渠道2',
        |user_channel STRING COMMENT '对接类别',
        |org_lno2 STRING COMMENT '机构编码2',
        |mall_name STRING COMMENT '商场',
        |biz_group_name STRING COMMENT '商业集团',
        |store_type_name STRING COMMENT '店铺类型',
        |ma_name STRING COMMENT '管理区域',
        |biz_circle_name STRING COMMENT '商圈',
        |open_date STRING COMMENT '开店日',
        |close_date STRING COMMENT '关店日',
        |point_store STRING COMMENT '是否指数店',
        |area_total DECIMAL(18,4) COMMENT '总面积',
        |biz_area DECIMAL(18,4) COMMENT '营业面积',
        |tel STRING COMMENT '电话',
        |cman_addr STRING COMMENT '地址',
        |strategic_positioning STRING COMMENT '战略定位',
        |cust_store STRING COMMENT '客流店铺',
        |is_large_org STRING COMMENT '大店标志',
        |latest_renewal_time STRING COMMENT '最新改造日期',
        |store_latitude STRING COMMENT '纬度',
        |store_longitude STRING COMMENT '经度',
        |send_big_region_name STRING COMMENT '发货大区',
        |send_region_name STRING COMMENT '发货地区',
        |virtual_big_region_name STRING COMMENT '虚店大区',
        |virtual_region_name STRING COMMENT '虚店地区',
        |virtual_mc_name STRING COMMENT '虚店管理城市',
        |is_waidan STRING COMMENT '是否外单扫描店铺',
        |sal_mode_name STRING COMMENT '销售形式',
        |sal_mode_cate_name STRING COMMENT '销售形式大类',
        |sy_region_name STRING COMMENT '业绩归属地区',
        |sy_big_region_name STRING COMMENT '业绩归属大区',
        |sy_mp_name STRING COMMENT '业绩归属管理省区',
        |sy_mc_name STRING COMMENT '业绩归属管理城市',
        |online_offline_name STRING COMMENT '原线上线下',
        |m_brd_season_name_attr STRING COMMENT '历史全品牌品牌季节名称',
        |size_order STRING COMMENT '尺寸排序',
        |amt_target DECIMAL(18,4) COMMENT '营业目标',
        |gwp_flag STRING COMMENT 'GWP标签',
        |all_sal_amt DECIMAL(18,4) COMMENT '整单销售额',
        |all_sal_qty BIGINT COMMENT '整单销售量',
        |shop_mode_name STRING COMMENT '私域店铺类型',
        |bad_balance_inv_qty BIGINT COMMENT '次品实物存量',
        |bad_balance_inv_amt DECIMAL(18,4) COMMENT '次品实物存额',
        |outer_manu_qty BIGINT COMMENT '正品退厂库存量',
        |outer_manu_amt DECIMAL(18,4) COMMENT '正品退厂库存额',
        |bad_outer_manu_qty BIGINT COMMENT '次品退厂库存量',
        |bad_outer_manu_amt DECIMAL(18,4) COMMENT '次品退厂库存额',
        |guest_bad_qty BIGINT COMMENT '客残量',
        |guest_bad_amt DECIMAL(18,4) COMMENT '客残额',
        |pre_destroy_qty BIGINT COMMENT '待销毁量',
        |pre_destroy_amt DECIMAL(18,4) COMMENT '待销毁额',
        |original_bad_qty BIGINT COMMENT '原残量',
        |original_bad_amt DECIMAL(18,4) COMMENT '原残额' )
        |USING parquet
      """.stripMargin)

    sql(
      """
        |CREATE VIEW kylin_view_ads_fact_pos_ord_analysis_wide AS SELECT period_sdate, qs_level_attr, pro_no, size_code, brd_dtl_no, brd_no, org_lno, store_lno, online_offline, order_no, order_dtl_id, ref_bill_no, main_order_no, third_order_no, yougou_order_dtl_id, order_type, old_order_no, old_order_dtl_id, is_new_no, is_new_name, virtual_activity_flag, nvl(sal_qty,0) AS sal_qty, nvl(sal_amt,0) AS sal_amt, nvl(sal_nos_prm_amt,0) AS sal_nos_prm_amt, nvl(sal_prm_amt,0) AS sal_prm_amt, nvl(wl_sal_qty,0) AS wl_sal_qty, nvl(wl_sal_amt,0) AS wl_sal_amt, nvl(wl_sal_nos_prm_amt,0) AS wl_sal_nos_prm_amt, nvl(wl_sal_prm_amt,0) AS wl_sal_prm_amt, nvl(surplus_amount,0) AS surplus_amount, nvl(prom_sal_amt,0) AS prom_sal_amt, nvl(prom_sal_qty,0) AS prom_sal_qty, nvl(prom_sal_nos_prm_amt,0) AS prom_sal_nos_prm_amt, nvl(customer_settle_amt,0) AS customer_settle_amt, nvl(customer_settle_price,0) AS customer_settle_price, nvl(ticket_settle_price,0) AS ticket_settle_price, nvl(ticket_settle_amt,0) AS ticket_settle_amt, nvl(cost_score,0) AS cost_score, nvl(base_score,0) AS base_score, nvl(sal_qty_sy,0) AS sal_qty_sy, nvl(sal_amt_sy,0) AS sal_amt_sy, nvl(sal_nos_prm_amt_sy,0) AS sal_nos_prm_amt_sy, nvl(sal_prm_amt_sy,0) AS sal_prm_amt_sy, nvl(sy_send_qty,0) AS sy_send_qty, nvl(sy_send_amt,0) AS sy_send_amt, nvl(sy_send_nos_prm_amt,0) AS sy_send_nos_prm_amt, nvl(sy_send_prm_amt,0) AS sy_send_prm_amt, nvl(discount_rate,0) AS discount_rate, nvl(discount_amt,0) AS discount_amt, nvl(rebate_amount,0) AS rebate_amount, nvl(sale_price,0) AS sale_price, nvl(area_disc_rate,0) AS area_disc_rate, nvl(country_disc_rate,0) AS country_disc_rate, across_flag, live_flag, ticket_no, ticket_name, pay_way, ticket_expense, ticket_discount, dy_plat_surplus_amount, nvl(enter_store_qty,0) enter_store_qty, cust_flow_flag, nvl(balance_qty,0) AS balance_qty, nvl(balance_prm_amt,0) AS balance_prm_amt, nvl(total_inv_qty,0) AS total_inv_qty, nvl(total_inv_prm_amt,0) AS total_inv_prm_amt, nvl(biz_inv_qty,0) AS biz_inv_qty, nvl(biz_inv_prm_amt,0) AS biz_inv_prm_amt, nvl(total_transit_in_qty,0) AS total_transit_in_qty, nvl(total_transit_in_amt,0) AS total_transit_in_amt, nvl(total_transit_in_account_qty,0) AS total_transit_in_account_qty, nvl(total_transit_in_account_amt,0) AS total_transit_in_account_amt, nvl(total_bad_transit_in_qty,0) AS total_bad_transit_in_qty, nvl(total_bad_transit_in_amt,0) AS total_bad_transit_in_amt, nvl(total_bad_transit_in_account_qty,0) AS total_bad_transit_in_account_qty, nvl(total_bad_transit_in_account_amt,0) AS total_bad_transit_in_account_amt, nvl(total_factory_in_qty,0) AS total_factory_in_qty, nvl(total_factory_in_amt,0) AS total_factory_in_amt, nvl(online_sal_inv,0) AS online_sal_inv, nvl(online_sal_amt,0) AS online_sal_amt, nvl(offline_sal_inv,0) AS offline_sal_inv, nvl(offline_sal_amt,0) AS offline_sal_amt, nvl(lock_qty,0) AS lock_qty, nvl(lock_amt,0) AS lock_amt, nvl(occupied_qty,0) AS occupied_qty, nvl(occupied_amt,0) AS occupied_amt, nvl(backup_qty,0) AS backup_qty, nvl(backup_amt,0) AS backup_amt, nvl(work_qty,0) AS work_qty, nvl(work_amt,0) AS work_amt, nvl(un_schedule_qty,0) AS un_schedule_qty, nvl(un_schedule_amt,0) AS un_schedule_amt, nvl(un_share_qty,0) AS un_share_qty, nvl(un_share_amt,0) AS un_share_amt, third_one_level_channel_name, third_one_level_channel_no, third_two_level_channel_name, third_two_level_channel_no, third_three_level_channel_name, third_three_level_channel_no, order_source, pay_name, status, pickup_date, adjust_flag, pay_time, asst_no, asst_name, if(pro_name_app is null or pro_name_app = '','无活动',pro_name_app) pro_name_app, prom_channel, rate_style, prom_source, prom_start_time, prom_end_time, template_no, template_type, batch_no, batch_name, prom_no, if(prom_name is null or prom_name = '', '无活动', prom_name) prom_name, price_change_bill_no, double_sale_flag, check_user_no, check_user, chat_id, community_operation, sys_source_name, time_flag, special_flag, likespecial_flag, special_white_flag, mem_id, change_start_time, change_end_time, unusual_sal_flag, level_attr, service_evaluation, service_star, tag_name, to_date(from_unixtime(UNIX_TIMESTAMP(evaluation_date,'yyyyMMdd'))) evaluation_date, shop_no, shop_no_from, shop_name_from, table_source, sales_date, logistics_mode, distributor_flag, center_distributor_flag, is_online, merchant_no, distributor_no, distributor_employee_code, distributor_employee_name, distributor_shop_no, distributor_shop_name, distributor_region_name, distributor_big_region_name, distributor_mp_name, distributor_mc_name, distributor_merchant_no, distributor_employee_type, distributor_store_main_brd_no, distributor_department1, distributor_department2, room_id, express_no, logistics_name, actual_postage, stock_in_province, stock_in_city, sy_org_lno, sy_flag, merchant_name, member_join_chat_follow_nos_flag, private_member_join_chat_follow_nos_flag, member_shop_join_nos_flag, private_member_shop_join_nos_flag, follow_nos_flag, private_follow_nos_flag, platform_name, case when special_sell_flag = '品牌活动' then '品牌团购' else special_sell_flag end special_sell_flag, sal_mode_cate, etl_create_time, etl_update_time, time_range, brd_season_stc, brd_season_type_name, brd_season_type_order, lsg_mon_qty, brd_season_no, brd_season_group, brd_season_group_order, ticket_buy_amt, sal_cost_amt, real_pay_time, commission_order_type, online_offline_cate_name, online_offline_name_new, all_cate_name, sex, abnormal_mem_type, black_type, white_type, wholesale_type, warning_times, mem_brd_no, mem_status, reg_source, reg_store, reg_big_region_name, reg_region_name, reg_mp_name, reg_mc_name, reg_biz_city_name, reg_store_brd, reg_date, level_name, paid_mem_level, shop_name, is_online_name, employee_native_merchant_no, room_name, live_anchor_name, live_employee_no, live_share_img, live_brand_code, live_region_name, live_shop_no, live_shop_name, live_start_time, live_end_time, live_start_hour_name, distributor_retail_province_name, distributor_retail_director_code, distributor_retail_director_name, distributor_retail_manager_code, distributor_retail_manager_name, native_distributor_flag, sy_org_name, nvl(nos_discount,0) AS nos_discount, to_date(period_date) period_date, fin_year, fin_qtr, year_week, year_month, weekend, nl_holiday, nl_sdate, brd_group_name, brd_group_order, brd_abbr, brd_cname, brd_order, brd_dtl_abbr, brd_dtl_ename, pro_code, pro_name, pic_url, brd_season_name, brd_season_order, brd_pro_season, lsg_day, lsg_month, lsg_year, pro_cate_name, pro_cate_order, nba_logo, pro_down_name, pro_length_name, pro_series_name1, pro_series_name2, pro_series_name3, pro_gender_name, nvl(pro_prm,0) AS pro_prm, pro_prm_range, pro_repeat_lsg, qs_level, pro_style_name, pro_sub_style_name, pro_brd_style_name, pro_repeat_season, brd_channel, pro_brd, age_segment, latest_order_season, m_brd_season_name, m_brd_season_order, m_pro_cate_name, m_pro_cate_order, m_pro_down_name, m_pro_gender_name, m_pro_length_name, m_pro_series_name1, m_pro_style_name, m_pro_sub_style_name, nk_cate, offering_date, plate_code, pro_biz_brd, pro_brd_section2, pro_buying_type, pro_cate_flag, pro_channel, pro_channel_supply, pro_chinese_subject, pro_core_models, pro_distri, pro_event_subdivision, pro_evergreen, pro_fabric_tech, pro_form, pro_function, pro_goods_nature, pro_main_color, pro_deputy_color, pro_mt_gender, pro_mt_season, pro_mt_style, pro_national_team, ballstar, ballteam, pro_pop, pro_season, pro_shoes_style, pro_shoes_style2, size_type_code, size_type_name, size_segment, storage_type, pro_sport_event, pro_supplement, pro_support, pro_support_style, pro_support_style2, pro_tech, pro_type, org_new_no, org_name, big_region_name, big_region_order, region_no, region_name, region_order, mp_name, mc_name, biz_city_name, part_area_name, province_no, province_name, city_name, county_name, store_visualize, store_channel, store_level_name, multi_type, biz_attr_no, biz_attr_name, biz_attr_order, biz_attr_no2, biz_attr_name2, biz_attr_order2, store_brd_flag, key_store, type_level, store_brd, org_flag, retail_director_code, retail_director_name, retail_manager_code, retail_manager_name, vsr_director_code, vsr_director_name, vsr_manager_code, vsr_manager_name, train_director_code, train_director_name, train_manager_code, train_manager_name, onlineop_director_code, onlineop_director_name, onlineop_manager_code, onlineop_manager_name, store_abbr, self_checking_mode, biz_attr_name3, brd_flag, brd_store_no, store_status, order_unit_no, order_unit_name, retail_province_name, store_name, internal_channel, store_flag, level_no, property_cooperation_cond, settlement_mth, store_channel_name2, user_channel, org_lno2, mall_name, biz_group_name, store_type_name, ma_name, biz_circle_name, to_date(open_date) open_date, to_date(close_date) close_date, point_store, nvl(area_total,0) AS area_total, nvl(biz_area,0) AS biz_area, tel, cman_addr, strategic_positioning, cust_store, is_large_org, latest_renewal_time, store_latitude, store_longitude, send_big_region_name, send_region_name, virtual_big_region_name, virtual_region_name, virtual_mc_name, is_waidan, sal_mode_name, sal_mode_cate_name, sy_region_name, sy_big_region_name, sy_mp_name, sy_mc_name, if(table_source = 1,sal_qty,0) deal_nos_sal_qty, if(table_source = 1,sal_amt,0) deal_nos_sal_amt, if(table_source = 2,abs(sal_qty),0) deal_nos_return_sal_qty, if(table_source=2,abs(sal_amt),0) deal_nos_return_sal_amt, if(table_source = 1,mem_id,null) deal_nos_mem_id, if(table_source = 1,'发货','退货') send_return_flag, if(table_source = 1,order_no,null) deal_nos_order_no, online_offline_name, case when cust_flow_flag =1 and online_offline =1 and table_source =1 and asst_no is not null  and pro_cate_flag ='非物料' then order_no else null end as cr_flag, m_brd_season_name_attr, size_order, amt_target, gwp_flag, all_sal_amt, all_sal_qty, shop_mode_name, 0 as bad_balance_inv_qty, 0.0 as bad_balance_inv_amt, 0 as outer_manu_qty, 0.0 as outer_manu_amt, 0 as bad_outer_manu_qty, 0.0 as bad_outer_manu_amt, 0 as guest_bad_qty, 0.0 as guest_bad_amt, 0 as pre_destroy_qty, 0.0 as pre_destroy_amt, 0 as original_bad_qty, 0.0 as original_bad_amt, p_mon from ads_fact_pos_ord_analysis where period_sdate < date_format(current_date(), 'yyyyMMdd') UNION ALL SELECT period_sdate, qs_level_attr, pro_no, size_code, brd_dtl_no, brd_no, org_lno, store_lno, online_offline, order_no, order_dtl_id, ref_bill_no, main_order_no, third_order_no, yougou_order_dtl_id, order_type, old_order_no, old_order_dtl_id, is_new_no, is_new_name, virtual_activity_flag, nvl(sal_qty,0) AS sal_qty, nvl(sal_amt,0) AS sal_amt, nvl(sal_nos_prm_amt,0) AS sal_nos_prm_amt, nvl(sal_prm_amt,0) AS sal_prm_amt, nvl(wl_sal_qty,0) AS wl_sal_qty, nvl(wl_sal_amt,0) AS wl_sal_amt, nvl(wl_sal_nos_prm_amt,0) AS wl_sal_nos_prm_amt, nvl(wl_sal_prm_amt,0) AS wl_sal_prm_amt, nvl(surplus_amount,0) AS surplus_amount, nvl(prom_sal_amt,0) AS prom_sal_amt, nvl(prom_sal_qty,0) AS prom_sal_qty, nvl(prom_sal_nos_prm_amt,0) AS prom_sal_nos_prm_amt, nvl(customer_settle_amt,0) AS customer_settle_amt, nvl(customer_settle_price,0) AS customer_settle_price, nvl(ticket_settle_price,0) AS ticket_settle_price, nvl(ticket_settle_amt,0) AS ticket_settle_amt, nvl(cost_score,0) AS cost_score, nvl(base_score,0) AS base_score, nvl(sal_qty_sy,0) AS sal_qty_sy, nvl(sal_amt_sy,0) AS sal_amt_sy, nvl(sal_nos_prm_amt_sy,0) AS sal_nos_prm_amt_sy, nvl(sal_prm_amt_sy,0) AS sal_prm_amt_sy, nvl(sy_send_qty,0) AS sy_send_qty, nvl(sy_send_amt,0) AS sy_send_amt, nvl(sy_send_nos_prm_amt,0) AS sy_send_nos_prm_amt, nvl(sy_send_prm_amt,0) AS sy_send_prm_amt, nvl(discount_rate,0) AS discount_rate, nvl(discount_amt,0) AS discount_amt, nvl(rebate_amount,0) AS rebate_amount, nvl(sale_price,0) AS sale_price, nvl(area_disc_rate,0) AS area_disc_rate, nvl(country_disc_rate,0) AS country_disc_rate, across_flag, live_flag, ticket_no, ticket_name, pay_way, ticket_expense, ticket_discount, dy_plat_surplus_amount, nvl(enter_store_qty,0) enter_store_qty, cust_flow_flag, nvl(balance_qty,0) AS balance_qty, nvl(balance_prm_amt,0) AS balance_prm_amt, nvl(total_inv_qty,0) AS total_inv_qty, nvl(total_inv_prm_amt,0) AS total_inv_prm_amt, nvl(biz_inv_qty,0) AS biz_inv_qty, nvl(biz_inv_prm_amt,0) AS biz_inv_prm_amt, nvl(total_transit_in_qty,0) AS total_transit_in_qty, nvl(total_transit_in_amt,0) AS total_transit_in_amt, nvl(total_transit_in_account_qty,0) AS total_transit_in_account_qty, nvl(total_transit_in_account_amt,0) AS total_transit_in_account_amt, nvl(total_bad_transit_in_qty,0) AS total_bad_transit_in_qty, nvl(total_bad_transit_in_amt,0) AS total_bad_transit_in_amt, nvl(total_bad_transit_in_account_qty,0) AS total_bad_transit_in_account_qty, nvl(total_bad_transit_in_account_amt,0) AS total_bad_transit_in_account_amt, nvl(total_factory_in_qty,0) AS total_factory_in_qty, nvl(total_factory_in_amt,0) AS total_factory_in_amt, nvl(online_sal_inv,0) AS online_sal_inv, nvl(online_sal_amt,0) AS online_sal_amt, nvl(offline_sal_inv,0) AS offline_sal_inv, nvl(offline_sal_amt,0) AS offline_sal_amt, nvl(lock_qty,0) AS lock_qty, nvl(lock_amt,0) AS lock_amt, nvl(occupied_qty,0) AS occupied_qty, nvl(occupied_amt,0) AS occupied_amt, nvl(backup_qty,0) AS backup_qty, nvl(backup_amt,0) AS backup_amt, nvl(work_qty,0) AS work_qty, nvl(work_amt,0) AS work_amt, nvl(un_schedule_qty,0) AS un_schedule_qty, nvl(un_schedule_amt,0) AS un_schedule_amt, nvl(un_share_qty,0) AS un_share_qty, nvl(un_share_amt,0) AS un_share_amt, third_one_level_channel_name, third_one_level_channel_no, third_two_level_channel_name, third_two_level_channel_no, third_three_level_channel_name, third_three_level_channel_no, order_source, pay_name, status, pickup_date, adjust_flag, pay_time, asst_no, asst_name, if(pro_name_app is null or pro_name_app = '','无活动',pro_name_app) pro_name_app, prom_channel, rate_style, prom_source, prom_start_time, prom_end_time, template_no, template_type, batch_no, batch_name, prom_no, if(prom_name is null or prom_name = '', '无活动', prom_name) prom_name, price_change_bill_no, double_sale_flag, check_user_no, check_user, chat_id, community_operation, sys_source_name, time_flag, special_flag, likespecial_flag, special_white_flag, mem_id, change_start_time, change_end_time, unusual_sal_flag, level_attr, service_evaluation, service_star, tag_name, to_date(from_unixtime(UNIX_TIMESTAMP(evaluation_date,'yyyyMMdd'))) evaluation_date, shop_no, shop_no_from, shop_name_from, table_source, sales_date, logistics_mode, distributor_flag, center_distributor_flag, is_online, merchant_no, distributor_no, distributor_employee_code, distributor_employee_name, distributor_shop_no, distributor_shop_name, distributor_region_name, distributor_big_region_name, distributor_mp_name, distributor_mc_name, distributor_merchant_no, distributor_employee_type, distributor_store_main_brd_no, distributor_department1, distributor_department2, room_id, express_no, logistics_name, actual_postage, stock_in_province, stock_in_city, sy_org_lno, sy_flag, merchant_name, member_join_chat_follow_nos_flag, private_member_join_chat_follow_nos_flag, member_shop_join_nos_flag, private_member_shop_join_nos_flag, follow_nos_flag, private_follow_nos_flag, platform_name, case when special_sell_flag = '品牌活动' then '品牌团购' else special_sell_flag end special_sell_flag, sal_mode_cate, etl_create_time, etl_update_time, time_range, brd_season_stc, brd_season_type_name, brd_season_type_order, lsg_mon_qty, brd_season_no, brd_season_group, brd_season_group_order, ticket_buy_amt, sal_cost_amt, real_pay_time, commission_order_type, online_offline_cate_name, online_offline_name_new, all_cate_name, sex, abnormal_mem_type, black_type, white_type, wholesale_type, warning_times, mem_brd_no, mem_status, reg_source, reg_store, reg_big_region_name, reg_region_name, reg_mp_name, reg_mc_name, reg_biz_city_name, reg_store_brd, reg_date, level_name, paid_mem_level, shop_name, is_online_name, employee_native_merchant_no, room_name, live_anchor_name, live_employee_no, live_share_img, live_brand_code, live_region_name, live_shop_no, live_shop_name, live_start_time, live_end_time, live_start_hour_name, distributor_retail_province_name, distributor_retail_director_code, distributor_retail_director_name, distributor_retail_manager_code, distributor_retail_manager_name, native_distributor_flag, sy_org_name, nvl(nos_discount,0) AS nos_discount, to_date(period_date) period_date, fin_year, fin_qtr, year_week, year_month, weekend, nl_holiday, nl_sdate, brd_group_name, brd_group_order, brd_abbr, brd_cname, brd_order, brd_dtl_abbr, brd_dtl_ename, pro_code, pro_name, pic_url, brd_season_name, brd_season_order, brd_pro_season, lsg_day, lsg_month, lsg_year, pro_cate_name, pro_cate_order, nba_logo, pro_down_name, pro_length_name, pro_series_name1, pro_series_name2, pro_series_name3, pro_gender_name, nvl(pro_prm,0) AS pro_prm, pro_prm_range, pro_repeat_lsg, qs_level, pro_style_name, pro_sub_style_name, pro_brd_style_name, pro_repeat_season, brd_channel, pro_brd, age_segment, latest_order_season, m_brd_season_name, m_brd_season_order, m_pro_cate_name, m_pro_cate_order, m_pro_down_name, m_pro_gender_name, m_pro_length_name, m_pro_series_name1, m_pro_style_name, m_pro_sub_style_name, nk_cate, offering_date, plate_code, pro_biz_brd, pro_brd_section2, pro_buying_type, pro_cate_flag, pro_channel, pro_channel_supply, pro_chinese_subject, pro_core_models, pro_distri, pro_event_subdivision, pro_evergreen, pro_fabric_tech, pro_form, pro_function, pro_goods_nature, pro_main_color, pro_deputy_color, pro_mt_gender, pro_mt_season, pro_mt_style, pro_national_team, ballstar, ballteam, pro_pop, pro_season, pro_shoes_style, pro_shoes_style2, size_type_code, size_type_name, size_segment, storage_type, pro_sport_event, pro_supplement, pro_support, pro_support_style, pro_support_style2, pro_tech, pro_type, org_new_no, org_name, big_region_name, big_region_order, region_no, region_name, region_order, mp_name, mc_name, biz_city_name, part_area_name, province_no, province_name, city_name, county_name, store_visualize, store_channel, store_level_name, multi_type, biz_attr_no, biz_attr_name, biz_attr_order, biz_attr_no2, biz_attr_name2, biz_attr_order2, store_brd_flag, key_store, type_level, store_brd, org_flag, retail_director_code, retail_director_name, retail_manager_code, retail_manager_name, vsr_director_code, vsr_director_name, vsr_manager_code, vsr_manager_name, train_director_code, train_director_name, train_manager_code, train_manager_name, onlineop_director_code, onlineop_director_name, onlineop_manager_code, onlineop_manager_name, store_abbr, self_checking_mode, biz_attr_name3, brd_flag, brd_store_no, store_status, order_unit_no, order_unit_name, retail_province_name, store_name, internal_channel, store_flag, level_no, property_cooperation_cond, settlement_mth, store_channel_name2, user_channel, org_lno2, mall_name, biz_group_name, store_type_name, ma_name, biz_circle_name, to_date(open_date) open_date, to_date(close_date) close_date, point_store, nvl(area_total,0) AS area_total, nvl(biz_area,0) AS biz_area, tel, cman_addr, strategic_positioning, cust_store, is_large_org, latest_renewal_time, store_latitude, store_longitude, send_big_region_name, send_region_name, virtual_big_region_name, virtual_region_name, virtual_mc_name, is_waidan, sal_mode_name, sal_mode_cate_name, sy_region_name, sy_big_region_name, sy_mp_name, sy_mc_name, if(table_source = 1,sal_qty,0) deal_nos_sal_qty, if(table_source = 1,sal_amt,0) deal_nos_sal_amt, if(table_source = 2,abs(sal_qty),0) deal_nos_return_sal_qty, if(table_source=2,abs(sal_amt),0) deal_nos_return_sal_amt, if(table_source = 1,mem_id,null) deal_nos_mem_id, if(table_source = 1,'发货','退货') send_return_flag, if(table_source = 1,order_no,null) deal_nos_order_no, online_offline_name, case when cust_flow_flag =1 and online_offline =1 and table_source =1 and asst_no is not null  and pro_cate_flag ='非物料' then order_no else null end as cr_flag, m_brd_season_name_attr, size_order, amt_target, gwp_flag, all_sal_amt, all_sal_qty, shop_mode_name, bad_balance_inv_qty,  bad_balance_inv_amt, outer_manu_qty, outer_manu_amt, bad_outer_manu_qty, bad_outer_manu_amt, guest_bad_qty, guest_bad_amt, pre_destroy_qty, pre_destroy_amt, original_bad_qty, original_bad_amt, date_format(add_months(date_sub(current_date,1),1), 'yyyyMM') as p_mon FROM ads_fact_pos_ord_analysis_r where period_sdate = date_format(current_date(), 'yyyyMMdd')
      """.stripMargin)
  }


  val taoboQueries = Seq("1.1")

  taoboQueries.foreach { name =>
    val queryString = resourceToString(s"taobo/$name.sql",
      classLoader = Thread.currentThread.getContextClassLoader)


    test(name) {
      withSQLConf("spark.sql.codegen.wholeStage" -> "true",
        "spark.sql.codegen.fallback" -> "true",
        "spark.sql.codegen.factoryMode" -> "FALLBACK",
        "spark.sql.subexpressionEliminationInFilter.enabled" -> "true",
        "spark.sql.constraintPropagation.enabled" -> "true",
        "spark.driver.memory" -> "128m") {

        sql(queryString).collectAsList()
      }

      /* // check the plans can be properly generated
      val plan = sql(queryString).queryExecution.executedPlan
      checkGeneratedCode(plan) */
    }
  }
}
